---
title: "Binary Diffing"
date: 2023-08-19T15:56:52+08:00
toc: true
categories:
- Reverse
- Paper
tags:
- machine learning
- Smart Contract
- reverse
- binary diffing
---

æœ€è¿‘æƒ³çœ‹çœ‹binary diffingçš„å†…å®¹ï¼Œç›´æ¥ä»å¤´çœ‹çœ‹ä¸€ç¯‡ç¯‡ç¿»ï¼Œæ¶‰åŠåˆ°å¾ˆå¤šæœºå™¨å­¦ä¹ å†…å®¹ï¼Œå¾ˆå¤šä¸æ‡‚çš„ï¼Œæ…¢æ…¢æ¥çœ‹å§ã€‚è¿™é‡Œå…ˆçœ‹äº†10å‡ ç¯‡ï¼Œå¾ˆå¤šéƒ½åªçœ‹äº†ä¸€ä¸ªæ‘˜è¦ã€‚
ä¸»è¦æ˜¯äº†è§£ä¸€ä¸‹æ€è·¯ï¼Œçœ‹çœ‹è¿™ä¸ªé¢†åŸŸçš„å†…å®¹çš„ç ”ç©¶å†å²ï¼ŒBinary Diffing 1æš‚æ—¶åªçœ‹åˆ°2016å¹´çš„paperï¼Œåç»­ç»§ç»­æ›´æ–°ï¼Œä¸»è¦æ–‡ç« å¼•ç”¨å¦‚ä¸‹

+ Bitshred: feature hashing malware for scalable triage and semantic analysis. 
+ Binary function clustering using semantic hashes.
+ Binslayer: accurate comparison of binary executables. 
+ Control flow-based malware variant detection.
+ {MutantX-S}: Scalable Malware Clustering Based on Static Features. 
+ Semantics-based obfuscation-resilient binary code similarity comparison with applications to software plagiarism detection. 
+ Leveraging semantic signatures for bug search in binary programs. 
+ Cross-architecture bug search in binary executables. 
+ Bingo: Crossarchitecture cross-os binary search.
+ Statistical similarity of binaries.
+ discovRE: Efficient Cross-Architecture Identification of Bugs in Binary Code.
+ Scalable Graph-based Bug Search for Firmware Images. 
+ Crossarchitecture binary semantics understanding via similar code comparison. 

<!--more-->

# èƒŒæ™¯



## Bin diff

**åŸºæœ¬æµç¨‹**

1. è¯»å–ä¸¤ä¸ªå¾…æ¯”è¾ƒçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¾‹å¦‚ä¸¤ä¸ªå¯æ‰§è¡Œæ–‡ä»¶æˆ–åº“æ–‡ä»¶ã€‚
2. å¯¹æ¯ä¸ªæ–‡ä»¶è¿›è¡Œé™æ€åˆ†æï¼Œä»¥æå–å…¶ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å‡½æ•°ã€åŸºæœ¬å—ã€æŒ‡ä»¤åºåˆ—å’Œæ§åˆ¶æµç­‰ã€‚
3. å°†ä¸¤ä¸ªæ–‡ä»¶åˆ’åˆ†ä¸ºåŸºæœ¬å—ã€‚åŸºæœ¬å—æ˜¯ä¸€æ®µè¿ç»­çš„æŒ‡ä»¤åºåˆ—ï¼Œå®ƒä»¥åˆ†æ”¯æŒ‡ä»¤ï¼ˆå¦‚è·³è½¬æˆ–æ¡ä»¶åˆ†æ”¯ï¼‰æˆ–å‡½æ•°è°ƒç”¨ä¸ºè¾¹ç•Œã€‚
4. å¯¹ä¸¤ä¸ªæ–‡ä»¶çš„åŸºæœ¬å—è¿›è¡ŒåŒ¹é…ã€‚åŒ¹é…è¿‡ç¨‹é€šå¸¸åŸºäºæŒ‡ä»¤åºåˆ—ã€æ“ä½œæ•°å’Œæ§åˆ¶æµç­‰ç‰¹å¾è¿›è¡Œç›¸ä¼¼æ€§åº¦é‡ã€‚å¸¸ç”¨çš„åº¦é‡æ–¹æ³•åŒ…æ‹¬å“ˆå¸Œå‡½æ•°ã€ç¼–è¾‘è·ç¦»æˆ–ç»“æ„ç›¸ä¼¼æ€§æŒ‡æ ‡ã€‚
5. æ ¹æ®åŒ¹é…çš„åŸºæœ¬å—ï¼Œç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚è¿™äº›æ˜ å°„å…³ç³»è¡¨ç¤ºäº†ä¸¤ä¸ªæ–‡ä»¶ä¸­ç›¸ä¼¼çš„ä»£ç ç»“æ„ã€‚
6. åˆ†æä¸åŒ¹é…çš„åŸºæœ¬å—ã€‚è¿™äº›åŸºæœ¬å—è¡¨ç¤ºä¸¤ä¸ªæ–‡ä»¶ä¹‹é—´çš„å·®å¼‚ã€‚å¯ä»¥æ£€æµ‹åˆ°ä»£ç é‡ç”¨ã€å‡½æ•°é‡å‘½åã€æ’å…¥ã€åˆ é™¤å’Œä¿®æ”¹ç­‰æ“ä½œã€‚
7. ç”Ÿæˆå¯è§†åŒ–æŠ¥å‘Šã€‚ä½¿ç”¨å›¾å½¢è¡¨ç¤ºæ¥å±•ç¤ºä¸¤ä¸ªæ–‡ä»¶ä¹‹é—´çš„æ˜ å°„å…³ç³»å’Œå·®å¼‚ï¼Œå¸®åŠ©åˆ†æäººå‘˜ç†è§£å’Œæ¯”è¾ƒäºŒè¿›åˆ¶æ–‡ä»¶çš„ç»“æ„ã€‚

**å‡½æ•°ç›¸ä¼¼åº¦åŠ æƒå’Œï¼š**

- 25%ï¼ŒåŒ¹é…çš„flowå›¾ä¸­çš„è¾¹å æ€»è¾¹æ•°
- 15%ï¼ŒåŒ¹é…çš„åŸºæœ¬å—å åŸºæœ¬å—æ€»æ•°
- 10%ï¼ŒåŒ¹é…çš„æŒ‡ä»¤æ•°å æ€»æŒ‡ä»¤æ•°ç›®
- 50%ï¼Œdifference in flow graph MD index

**æ•´ä¸ªäºŒè¿›åˆ¶çš„ç›¸ä¼¼åº¦ï¼š**

- 35%ï¼ŒåŒ¹é…çš„flowå›¾ä¸­çš„è¾¹å æ€»è¾¹æ•°
- 25%ï¼ŒåŒ¹é…çš„åŸºæœ¬å—å åŸºæœ¬å—æ€»æ•°
- 10%ï¼ŒåŒ¹é…çš„å‡½æ•°å æ€»å‡½æ•°çš„æ¯”ä¾‹
- 10%ï¼ŒåŒ¹é…çš„æŒ‡ä»¤å æ€»æŒ‡ä»¤æ•°ç›®
- 20%ï¼Œdifference in call graph MD index

> MD indexï¼šåŸºäºå‡½æ•°çš„æ‹“æ‰‘é¡ºåºï¼Œå…¥åº¦å’Œå‡ºåº¦çš„CFGå“ˆå¸Œå‡½æ•°ã€‚å‚è€ƒ [MD-Index paper](https://www.sto.nato.int/publications/STO Meeting Proceedings/RTO-MP-IST-091/MP-IST-091-26.pdf)

## éšæœºæ£®æ—[^41]

æœºå™¨å­¦ä¹ ä¸­æœ‰ä¸¤ç§ä»»åŠ¡ï¼Œå›å½’å’Œåˆ†ç±»ï¼Œè€Œéšæœºæ£®æ—å¯ä»¥åŒæ—¶èƒœä»»è¿™ä¸¤ç§ä»»åŠ¡ã€‚å…¶ä¸­åˆ†ç±»ä»»åŠ¡æ˜¯å¯¹ç¦»æ•£å€¼è¿›è¡Œé¢„æµ‹ï¼ˆæ¯”å¦‚å°†ä¸€æ™¯å›¾åƒä¸­çš„æ¤è¢«ï¼Œå»ºç­‘ï¼Œæ°´ä½“ç­‰åœ°ç‰©ç±»å‹åˆ†ç±»ï¼‰ï¼›å›å½’ä»»åŠ¡æ˜¯å¯¹è¿ç»­å€¼è¿›è¡Œé¢„æµ‹ï¼ˆæ¯”å¦‚æ ¹æ®å·²æœ‰çš„æ•°æ®é¢„æµ‹æ˜å¤©çš„æ°”æ¸©æ˜¯å¤šå°‘åº¦ï¼Œé¢„æµ‹æ˜å¤©æŸåŸºé‡‘çš„ä»·æ ¼ï¼‰ã€‚

## N-grams[^42]

N-Gramæ˜¯ä¸€ç§åŸºäºç»Ÿè®¡è¯­è¨€æ¨¡å‹çš„ç®—æ³•ã€‚å®ƒçš„åŸºæœ¬æ€æƒ³æ˜¯å°†æ–‡æœ¬é‡Œé¢çš„å†…å®¹æŒ‰ç…§å­—èŠ‚è¿›è¡Œå¤§å°ä¸ºNçš„æ»‘åŠ¨çª—å£æ“ä½œï¼Œå½¢æˆäº†é•¿åº¦æ˜¯Nçš„å­—èŠ‚ç‰‡æ®µåºåˆ—ã€‚

æ¯ä¸€ä¸ªå­—èŠ‚ç‰‡æ®µç§°ä¸ºgramï¼Œå¯¹æ‰€æœ‰gramçš„å‡ºç°é¢‘åº¦è¿›è¡Œç»Ÿè®¡ï¼Œå¹¶ä¸”æŒ‰ç…§äº‹å…ˆè®¾å®šå¥½çš„é˜ˆå€¼è¿›è¡Œè¿‡æ»¤ï¼Œå½¢æˆå…³é”®gramåˆ—è¡¨ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªæ–‡æœ¬çš„å‘é‡ç‰¹å¾ç©ºé—´ï¼Œåˆ—è¡¨ä¸­çš„æ¯ä¸€ç§gramå°±æ˜¯ä¸€ä¸ªç‰¹å¾å‘é‡ç»´åº¦ã€‚

è¯¥æ¨¡å‹åŸºäºè¿™æ ·ä¸€ç§å‡è®¾ï¼Œç¬¬Nä¸ªè¯çš„å‡ºç°åªä¸å‰é¢N-1ä¸ªè¯ç›¸å…³ï¼Œè€Œä¸å…¶å®ƒä»»ä½•è¯éƒ½ä¸ç›¸å…³ï¼Œæ•´å¥çš„æ¦‚ç‡å°±æ˜¯å„ä¸ªè¯å‡ºç°æ¦‚ç‡çš„ä¹˜ç§¯ã€‚è¿™äº›æ¦‚ç‡å¯ä»¥é€šè¿‡ç›´æ¥ä»è¯­æ–™ä¸­ç»Ÿè®¡Nä¸ªè¯åŒæ—¶å‡ºç°çš„æ¬¡æ•°å¾—åˆ°ã€‚å¸¸ç”¨çš„æ˜¯äºŒå…ƒçš„Bi-Gramå’Œä¸‰å…ƒçš„Tri-Gramã€‚

# æ–‡ç« 

## Bitshred: feature hashing malware for scalable triage and semantic analysis.[^1]

tag: `2011`

### æ‘˜è¦

ä¸€ä¸ªç”¨äºå¤§è§„æ¨¡æ¶æ„è½¯ä»¶ç›¸ä¼¼æ€§åˆ†æå’Œèšç±»çš„ç³»ç»Ÿï¼Œå¹¶ç”¨äºè‡ªåŠ¨å‘ç°é›†ç¾¤å†…çš„è¯­ä¹‰å®¶æ—é—´å’Œå®¶æ—å†…å…³ç³»ã€‚BitShredèƒŒåçš„å…³é”®æ€æƒ³æ˜¯ä½¿ç”¨ç‰¹å¾å“ˆå¸Œæ¥æ˜¾è‘—å‡å°‘æ¶æ„è½¯ä»¶åˆ†æä¸­å¸¸è§çš„é«˜ç»´ç‰¹å¾ç©ºé—´ã€‚ç‰¹å¾å“ˆå¸Œè¿˜å…è®¸æˆ‘ä»¬ä½¿ç”¨å…±èšç±»æŠ€æœ¯æŒ–æ˜æ¶æ„è½¯ä»¶å®¶æ—å’Œæ ·æœ¬ä¹‹é—´çš„ç›¸å…³ç‰¹å¾

## Binary function clustering using semantic hashes.[^2]

tag: `2012`

### æ‘˜è¦

åœ¨å¤§é‡äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ä¸­è¯†åˆ«è¯­ä¹‰ç›¸å…³å‡½æ•°çš„èƒ½åŠ›å¯¹äºæ¶æ„è½¯ä»¶æ£€æµ‹éå¸¸é‡è¦ã€‚ç›´è§‚ä¸Šï¼Œå¦‚æœä¸¤æ®µä»£ç å¯¹æœºå™¨çš„çŠ¶æ€æœ‰ç›¸åŒçš„æ•ˆæœï¼Œé‚£ä¹ˆå®ƒä»¬æ˜¯ç›¸ä¼¼çš„ã€‚å½“å‰æœ€å…ˆè¿›çš„å·¥å…·é‡‡ç”¨å„ç§å¯¹æ˜æ™ºçš„æ¯”è¾ƒ(ä¾‹å¦‚ï¼Œä½¿ç”¨SMTæ±‚è§£å™¨çš„æ¨¡æ¿åŒ¹é…ï¼Œå…³é”®ç¨‹åºç‚¹çš„å€¼é›†åˆ†æï¼ŒAPIè°ƒç”¨åŒ¹é…ç­‰)ã€‚ç„¶è€Œï¼Œè¿™äº›æ–¹æ³•å¯¹äºå¤§å°ä¸ºNçš„å¤§å‹æ•°æ®é›†èšç±»æ˜¯ä¸å¯åŠ¨æ‘‡çš„ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦O(N2)æ¯”è¾ƒã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§åŸºäºâ€œå“ˆå¸Œâ€çš„æ›¿ä»£æ–¹æ³•ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ç§å°†å‡½æ•°çš„è¯­ä¹‰æ•è·ä¸ºè¯­ä¹‰å“ˆå¸Œçš„æ–¹æ¡ˆã€‚æˆ‘ä»¬çš„æ–¹æ³•å°†å‡½æ•°è§†ä¸ºä¸€ç»„ç‰¹å¾ï¼Œæ¯ä¸ªç‰¹å¾ä»£è¡¨ä¸€ä¸ªåŸºæœ¬å—çš„è¾“å…¥-è¾“å‡ºè¡Œä¸ºã€‚ä½¿ç”¨ä¸€ç§ç§°ä¸ºæœ€å°å“ˆå¸Œçš„ä½ç½®æ•æ„Ÿå“ˆå¸Œå½¢å¼ï¼Œå¯ä»¥å¿«é€Ÿè¯†åˆ«å…·æœ‰è®¸å¤šå…±åŒç‰¹å¾çš„å‡½æ•°ï¼Œå¹¶ä¸”å°†èšç±»çš„å¤æ‚æ€§é™ä½åˆ°0 (N)ã€‚

## Binslayer: accurate comparison of binary executables. [^3]

tag: `2013`

### æ‘˜è¦

æœ¬æ–‡å°†è‘—åçš„BinDiffç®—æ³•ä¸äºŒåˆ†å›¾åŒ¹é…çš„åŒˆç‰™åˆ©ç®—æ³•ç›¸èåˆï¼Œæå‡ºäº†ä¸€ç§è®¡ç®—äºŒå€¼å›¾ä¹‹å·®çš„å¤šé¡¹å¼ç®—æ³•ã€‚è¿™å¤§å¤§æé«˜äº†åŒ¹é…ç²¾åº¦ã€‚æ­¤å¤–ï¼ŒåŸºäºå›¾ç¼–è¾‘è·ç¦»è®¡ç®—ä¸€ä¸ªæœ‰æ„ä¹‰çš„ç›¸ä¼¼æ€§åº¦é‡ï¼Œä»ä¸­å¯ä»¥å¯¹äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œæ˜æ™ºçš„æ¯”è¾ƒã€‚

## control flow-based malware variant detection. [^4]

tag: `2013`

### æ‘˜è¦

æœ¬æ–‡æå‡ºäº†ä¸€ç§æ¶æ„è½¯ä»¶ç›¸ä¼¼æ€§æœç´¢æ–¹æ³•ï¼Œåˆ©ç”¨æ–°é¢–çš„è·ç¦»åº¦é‡æ¥æ£€æµ‹è¿™äº›å˜ç§ã€‚æœ¬æ–‡é€šè¿‡æ¶æ„è½¯ä»¶åŒ…å«çš„æ§åˆ¶æµå›¾é›†æ¥æè¿°æ¶æ„è½¯ä»¶ç‰¹å¾ã€‚æœ¬æ–‡ä½¿ç”¨çš„è·ç¦»åº¦é‡æ˜¯åŸºäºå­—ç¬¦ä¸²ç­¾åçš„ç‰¹å¾å‘é‡ä¹‹é—´çš„è·ç¦»ã€‚ç‰¹å¾å‘é‡æ˜¯å°†å›¾é›†åˆ†è§£ä¸ºå›ºå®šå¤§å°çš„ k ä¸ªå­å›¾ï¼Œæˆ–è€…æ˜¯åç¼–è¯‘åé«˜çº§æºçš„ q ä¸ªå­—ç¬¦ä¸²ã€‚æœ¬æ–‡ä½¿ç”¨è¿™ç§è·ç¦»åº¦é‡æ¥æ‰§è¡Œé¢„è¿‡æ»¤ã€‚æœ¬æ–‡è¿˜æå‡ºäº†ä¸€ç§åŸºäºæœ€å°åŒ¹é…è·ç¦»çš„æ›´æœ‰æ•ˆä½†è®¡ç®—æ•ˆç‡è¾ƒä½çš„è·ç¦»åº¦é‡ã€‚æœ€å°åŒ¹é…è·ç¦»ä½¿ç”¨ç¨‹åºåç¼–è¯‘æµç¨‹å›¾ä¹‹é—´çš„å­—ç¬¦ä¸²ç¼–è¾‘è·ç¦»å’Œçº¿æ€§å’Œèµ‹å€¼é—®é¢˜æ¥æ„å»ºä¸¤ç»„å›¾ä¹‹é—´çš„æœ€å°å’Œæƒé‡åŒ¹é…ã€‚æœ¬æ–‡åœ¨ä¸€ä¸ªå®Œæ•´çš„æ¶æ„è½¯ä»¶å˜ç§æ£€æµ‹ç³»ç»Ÿä¸­å®ç°äº†è·ç¦»åº¦é‡ã€‚è¯„ä¼°ç»“æœè¡¨æ˜ï¼Œæˆ‘ä»¬çš„æ–¹æ³•åœ¨æœ‰é™çš„è¯¯æŠ¥ç‡æ–¹é¢éå¸¸æœ‰æ•ˆï¼Œä¸å…¶ä»–ç®—æ³•çš„æ£€æµ‹ç‡ç›¸æ¯”ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿèƒ½æ£€æµ‹å‡ºæ›´å¤šçš„æ¶æ„è½¯ä»¶å˜ç§ã€‚

## MutantX-S: Scalable Malware Clustering Based on Static Features. [^5]

tag: `é™æ€åˆ†æ`ï¼Œ`n-gram`ï¼Œ`2013`

### æ‘˜è¦

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è®¾è®¡ï¼Œå®ç°å’Œè¯„ä¼°äº†ä¸€ä¸ªæ–°çš„ï¼Œå¯æ‰©å±•çš„æ¡†æ¶ï¼Œç§°ä¸ºMutantX-Sï¼Œå®ƒå¯ä»¥æ ¹æ®ç¨‹åºçš„é™æ€ç‰¹å¾(å³ä»£ç æŒ‡ä»¤åºåˆ—)æœ‰æ•ˆåœ°å°†å¤§é‡æ ·æœ¬èšç±»åˆ°æ—ä¸­ã€‚MutantX-Sæ˜¯å‡ ç§æ–°æŠ€æœ¯çš„ç‹¬ç‰¹ç»„åˆï¼Œç”¨äºè§£å†³æ¶æ„è½¯ä»¶é›†ç¾¤çš„å®é™…æŒ‘æˆ˜ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒåˆ©ç”¨x86æ¶æ„çš„æŒ‡ä»¤æ ¼å¼ï¼Œå°†ç¨‹åºè¡¨ç¤ºä¸ºæ“ä½œç åºåˆ—ï¼Œä¾¿äºæå–N-gramç‰¹å¾ã€‚å®ƒè¿˜åˆ©ç”¨æœ€è¿‘åœ¨æœºå™¨å­¦ä¹ ç¤¾åŒºå¼€å‘çš„å“ˆå¸ŒæŠ€å·§æ¥é™ä½æå–çš„ç‰¹å¾å‘é‡çš„ç»´æ•°ï¼Œä»è€Œæ˜¾ç€é™ä½å†…å­˜éœ€æ±‚å’Œè®¡ç®—æˆæœ¬ã€‚æˆ‘ä»¬ä½¿ç”¨è¶…è¿‡130,000ä¸ªæ¶æ„è½¯ä»¶æ ·æœ¬çš„æ•°æ®åº“å¯¹MutantX-SåŸå‹è¿›è¡Œäº†å…¨é¢è¯„ä¼°ï¼Œæ˜¾ç¤ºå…¶èƒ½å¤Ÿåœ¨2å°æ—¶å†…æ­£ç¡®èšé›†è¶…è¿‡80%çš„æ ·æœ¬ï¼Œå®ç°äº†å‡†ç¡®æ€§å’Œå¯æ‰©å±•æ€§ä¹‹é—´çš„è‰¯å¥½å¹³è¡¡ã€‚å°†MutantX-Såº”ç”¨äºä¸åŒæ—¶é—´åˆ›å»ºçš„æ¶æ„è½¯ä»¶æ ·æœ¬ï¼Œæˆ‘ä»¬è¿˜è¯æ˜äº†MutantX-Såœ¨é¢„æµ‹ä»¥å‰æœªçŸ¥çš„æ¶æ„è½¯ä»¶æ ‡ç­¾æ–¹é¢è¾¾åˆ°äº†å¾ˆé«˜çš„å‡†ç¡®æ€§ã€‚

### å…·ä½“

é’ˆå¯¹æ¶æ„æ ·æœ¬çš„å˜å½¢ï¼Œæ¶æ„æ ·æœ¬é€šå¸¸ä¼šè¡ç”Ÿæˆä¸€ä¸ªåºå¤§çš„æ ·æœ¬å®¶æ—ï¼Œåœ¨åŸå§‹çš„ä¸Šé¢è¿›è¡Œæ‹“å±•æˆ–ä¿®æ”¹ã€‚å†æ¯å¤©é¢å¯¹æˆåƒä¸Šä¸‡ç–‘ä¼¼æ¶æ„æ ·æœ¬çš„æäº¤æ˜¯ï¼Œäººå·¥åˆ†ææ˜¯å›°éš¾çš„ã€‚æœ¬æ–‡é€šè¿‡åˆ†æé™æ€åˆ†æåŸå§‹æ ·æœ¬ï¼Œç–‘ä¼¼æ ·æœ¬ï¼Œå¹¶æå–ç‰¹å¾ï¼Œä½¿ç”¨N-gramåˆ†æåå¾—åˆ°ç›¸ä¼¼åº¦ï¼Œå¯ä»¥ç”¨äºå¤§è§„æ¨¡èšç±»

1. é¢„å¤„ç†ï¼Œè„±å£³è§£åŒ…æš´éœ²åŸå§‹æŒ‡ä»¤
2. æŒ‡ä»¤ç¼–ç ï¼šå°†æ¯æ¡æŒ‡ä»¤è½¬åŒ–ä¸ºæ“ä½œç 
3. N-gramåˆ†æï¼šæ„å»ºç‰¹å¾å‘é‡ä»¥ä¾¿è®¡ç®—ç¨‹åºçš„ç›¸ä¼¼æ€§
4. å“ˆå¸Œï¼šå‹ç¼©ç‰¹å¾å‘é‡ï¼Œæé«˜ç›¸ä¼¼æ€§è®¡ç®—é€Ÿåº¦ï¼ˆåªå¯¹èšç±»çš„å‡†ç¡®æ€§é€ æˆå¾ˆå°çš„å½±å“ï¼‰

æœ€å,åœ¨å‹ç¼©ç‰¹å¾å‘é‡çš„é›†åˆåº”ç”¨**åŸºäºåŸå‹çš„èšç±»ç®—æ³•**å’Œåˆ†åŒºæ ·æœ¬åˆ°ä¸åŒçš„é›†ç¾¤,æ¯ä¸ªä»£è¡¨ä¸€ç»„ç±»ä¼¼çš„æ¶æ„ç¨‹åºã€‚

é¢„å¤„ç†å°±æ˜¯ä»å†…å­˜ä¸­æå–åŸå§‹æŒ‡ä»¤ï¼Œä¸é€‚ç”¨äºç°åœ¨çš„å¤æ‚åœºæ™¯ï¼Œæ¯”å¦‚è‡ªè§£ç ç­‰

æŒ‡ä»¤ç¼–ç å®é™…ä¸Šæ˜¯äººå·¥è®¾å®šäº†ä¸€éƒ¨åˆ†æŒ‡ä»¤ç¼–ç æ¥ä»£æ›¿å¯¹åº”çš„æ±‡ç¼–æŒ‡ä»¤ç»„ï¼ˆæ¯”å¦‚è¿™ä¸€äº›æŒ‡ä»¤è¡¨ç¤ºä»å¯„å­˜å­˜å–æ•°æ®ï¼‰

<img src="https://raw.githubusercontent.com/Military-axe/imgtable/main/202308191555432.png" alt="image-20230814101200464" style="zoom:50%;" />

åˆ†æä½¿ç”¨æ ‡å‡†çš„[N-gramåˆ†ææ³•](https://zhuanlan.zhihu.com/p/32829048)ï¼Œåºåˆ—ä¸Šæœ‰ä¸€ä¸ªå›ºå®šå¤§å°çš„ç§»åŠ¨çª—å£ï¼Œçª—å£å†…å®¹å°±æ˜¯æ¶æ„æ ·æœ¬å†…å®¹

N-gramçš„Næ˜¯nä¸ªå­åºåˆ—ï¼Œå¯¹åº”çš„å°±æ˜¯Nä¸ªæ“ä½œç ï¼Œæ„å»ºäº†ä¸€ä¸ª|S|ç»´çš„å‘é‡ç©ºé—´(\\(|S|=|O|^N\\)ï¼ŒOæ˜¯æ‰€æœ‰å¯èƒ½æ“ä½œç çš„é›†åˆ)çš„ç»“æ„å‘é‡\\(V\\)ï¼Œ\\(V\\)çš„æ¯ä¸ªç»´æ•°æ˜¯ä¸€ä¸ªç‰¹å®šçš„æ“ä½œç ã€‚

é‚£ä¹ˆä¸¤ä¸ªæ¶æ„ç¨‹åº\\((m,v)\\)çš„ ç›¸ä¼¼æ€§å¯ä»¥ç”¨å‘é‡ç©ºé—´ä¸­çš„ç‰¹å¾å‘é‡ä¹‹é—´çš„æ¬§å¼è·ç¦»æ¥è¡¡é‡
$$
d(m,v)=||V_m-V_n||=\sqrt{\sum_{i=1}|S|(V_m(i)-(V_n(i))^2}
$$
**èšç±»ç®—æ³•**

MutantX-Sçš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ä¸ªçŸ­æ—¶é—´å¯ä»¥å¤„ç†åä¸‡ä¸ªæ¶æ„è½¯ä»¶æ–‡ä»¶ï¼Œç»å…¸çš„åˆ†åŒºå’Œåˆ†å±‚èšç±»æ²¡æœ‰è¿™ä¸ªå¤„ç†é€Ÿåº¦ã€‚

+ hashå‹ç¼©å‘é‡
+ åŸºäºåŸå‹çš„çº¿æ€§æ—¶é—´èšç±»ç®—æ³•

åŸºäºåŸå‹çš„èšç±»æ•ˆæœå¾ˆä¾èµ–åŸå‹çš„é€‰æ‹©ï¼Œä½¿ç”¨çš„æ˜¯Gonzalezæå‡ºçš„è¿‘ä¼¼ç®—æ³•æ¥è·Œå¸¦å¯»æ‰¾åŸå‹

## Semantics-based obfuscation-resilient binary code similarity comparison with applications to software plagiarism detection[^6]

tag: `2014`

### æ‘˜è¦

ç°æœ‰çš„ä»£ç ç›¸ä¼¼åº¦æ¯”è¾ƒæ–¹æ³•ï¼Œæ— è®ºæ˜¯åŸºäºæºä»£ç è¿˜æ˜¯åŸºäºäºŒè¿›åˆ¶ä»£ç ï¼Œå¤§å¤šæ•°éƒ½ä¸èƒ½é€‚åº”æ··æ·†ã€‚åœ¨è½¯ä»¶å‰½çªƒçš„æƒ…å†µä¸‹ï¼Œæ–°å…´çš„æ··æ·†æŠ€æœ¯ä½¿å¾—è‡ªåŠ¨æ£€æµ‹å˜å¾—è¶Šæ¥è¶Šå›°éš¾ã€‚æœ¬æ–‡æå‡ºäº†ä¸€ç§åŸºäºè¯­ä¹‰ç­‰æ•ˆåŸºæœ¬å—çš„æœ€é•¿å…¬å…±å­åºåˆ—æ¦‚å¿µçš„é¢å‘äºŒè¿›åˆ¶çš„æŠ—æ··æ·†æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†ä¸¥æ ¼çš„ç¨‹åºè¯­ä¹‰ä¸åŸºäºæœ€é•¿å…¬å…±å­åºåˆ—çš„æ¨¡ç³ŠåŒ¹é…ç›¸ç»“åˆã€‚æˆ‘ä»¬é€šè¿‡ä¸€ç»„è¡¨ç¤ºå—çš„è¾“å…¥-è¾“å‡ºå…³ç³»çš„ç¬¦å·å…¬å¼æ¥å»ºæ¨¡åŸºæœ¬å—çš„è¯­ä¹‰ã€‚è¿™æ ·ï¼Œä¸¤ä¸ªåŒºå—çš„è¯­ä¹‰ç­‰ä»·(å’Œç›¸ä¼¼åº¦)å°±å¯ä»¥ç”±å®šç†è¯æ˜è€…æ¥æ£€éªŒã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ä»¥åŸºæœ¬å—ä¸ºå…ƒç´ çš„æœ€é•¿å…¬å…±å­åºåˆ—å¯¹ä¸¤æ¡è·¯å¾„çš„è¯­ä¹‰ç›¸ä¼¼æ€§è¿›è¡Œå»ºæ¨¡ã€‚è¿™ç§æ–°é¢–çš„ç»„åˆå¯¼è‡´äº†å¯¹ä»£ç æ··æ·†çš„å¼ºå¤§å¼¹æ€§ã€‚æˆ‘ä»¬å·²ç»å¼€å‘äº†ä¸€ä¸ªåŸå‹ï¼Œå®éªŒç»“æœè¡¨æ˜æˆ‘ä»¬çš„æ–¹æ³•åœ¨å®é™…è½¯ä»¶ä¸­æ˜¯æœ‰æ•ˆå’Œå®ç”¨çš„ã€‚

## Leveraging semantic signatures for bug search in binary programs[^7]

tag: `2014`

### æ‘˜è¦

è½¯ä»¶æ¼æ´ä»ç„¶æ„æˆå¾ˆé«˜çš„å®‰å…¨é£é™©ï¼Œä¿®è¡¥å·²çŸ¥æ¼æ´çš„ç«èµ›æ­£åœ¨è¿›è¡Œä¸­ã€‚ç„¶è€Œï¼Œç‰¹åˆ«æ˜¯åœ¨é—­æºè½¯ä»¶ä¸­ï¼Œå³ä½¿bugå·²ç»å…¬å¼€ï¼Œä¹Ÿæ²¡æœ‰ç›´æ¥çš„æ–¹æ³•(ä¸æºä»£ç åˆ†æç›¸å)æ¥å‘ç°å­˜åœ¨bugçš„ä»£ç éƒ¨åˆ†ã€‚

é’ˆå¯¹è¿™ä¸€é—®é¢˜ï¼Œæå‡ºäº†ä¸€ç§åŸºäºæ ‘ç¼–è¾‘è·ç¦»çš„ç­‰è·åŒ¹é…(Tree Edit Distance Based Equational Matching, TEDEM)æ–¹æ³•ï¼Œ**ç”¨äºè‡ªåŠ¨è¯†åˆ«ä¸åŒ…å«å¼•ç”¨é”™è¯¯çš„ä»£ç åŒºåŸŸâ€œç›¸ä¼¼â€çš„äºŒè¿›åˆ¶ä»£ç åŒºåŸŸ**ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨ä¸å¼•ç”¨é”™è¯¯ç›¸åŒçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ‰¾åˆ°bugï¼Œä¹Ÿåœ¨å®Œå…¨ä¸ç›¸å…³çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ‰¾åˆ°bug(å³ä½¿æ˜¯ä¸ºä¸åŒçš„æ“ä½œç³»ç»Ÿç¼–è¯‘çš„)ã€‚æˆ‘ä»¬çš„æ–¹æ³•ç”šè‡³é€‚ç”¨äºç¼ºä¹æºä»£ç å’Œç¬¦å·çš„ä¸“æœ‰è½¯ä»¶ç³»ç»Ÿã€‚

åˆ†æä»»åŠ¡åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µã€‚åœ¨é¢„å¤„ç†é˜¶æ®µï¼Œé€šè¿‡ç¬¦å·ç®€åŒ–å‹ç¼©ç»™å®šäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶çš„è¯­ä¹‰ï¼Œä»¥ä½¿æ‰€æå‡ºæ–¹æ³•å¯¹ä¸åŒäºŒè¿›åˆ¶æ–‡ä»¶çš„è¯­æ³•å˜åŒ–å…·æœ‰é²æ£’æ€§ã€‚å…¶æ¬¡ï¼Œä½¿ç”¨æ ‘ç¼–è¾‘è·ç¦»ä½œä¸ºåŸºæœ¬çš„ä»¥å—ä¸ºä¸­å¿ƒçš„ä»£ç ç›¸ä¼¼æ€§åº¦é‡ã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸åŒçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ‰¾åˆ°ç›¸åŒbugçš„å®ä¾‹ï¼Œç”šè‡³å‘ç°å®ƒçš„å˜ä½“(è¿™ä¸ªæ¦‚å¿µç§°ä¸ºæ¼æ´å¤–æ¨)ã€‚ä¸ºäº†éªŒè¯æ‰€ææ–¹æ³•çš„å¯è¡Œæ€§ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªTEDEMåŸå‹ï¼Œå®ƒå¯ä»¥è·¨è¶ŠäºŒè¿›åˆ¶æ–‡ä»¶ç”šè‡³è·¨æ“ä½œç³»ç»Ÿè¾¹ç•Œå‘ç°çœŸå®ä¸–ç•Œä¸­çš„å®‰å…¨æ¼æ´ï¼Œå¦‚åœ¨MS Wordä»¥åŠæµè¡Œçš„ä¿¡ä½¿Pidgin (Linux)å’ŒAdium (Mac OS)ä¸­ã€‚

## When Coding Style Survives Compilation: De-anonymizing Programmers from Executable Binaries[^8]

tag: `2015`

### æ‘˜è¦

åŸºäºç¼–ç¨‹é£æ ¼è¯†åˆ«ç¨‹åºä½œè€…çš„èƒ½åŠ›æ˜¯å¯¹ç¨‹åºå‘˜éšç§å’ŒåŒ¿åæ€§çš„ç›´æ¥å¨èƒã€‚è™½ç„¶æœ€è¿‘çš„å·¥ä½œå‘ç°æºä»£ç å¯ä»¥é«˜ç²¾åº¦åœ°å½’å› äºä½œè€…ï¼Œä½†å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„å½’å› äºä¼¼ä¹è¦å›°éš¾å¾—å¤šã€‚æºä»£ç ä¸­å­˜åœ¨çš„è®¸å¤šæ˜¾è‘—ç‰¹å¾ï¼Œä¾‹å¦‚å˜é‡åï¼Œåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šè¢«åˆ é™¤ï¼Œç¼–è¯‘å™¨ä¼˜åŒ–å¯èƒ½ä¼šæ”¹å˜ç¨‹åºçš„ç»“æ„ï¼Œè¿›ä¸€æ­¥æ¨¡ç³Šé‚£äº›åœ¨ç¡®å®šä½œè€…èº«ä»½æ–¹é¢æœ‰ç”¨çš„ç‰¹å¾ã€‚**æœ¬æ–‡ä»æœºå™¨å­¦ä¹ çš„è§’åº¦ç ”ç©¶äº†ç¨‹åºå‘˜å»åŒ¿ååŒ–ï¼Œä½¿ç”¨ä¸€ç»„æ–°çš„ç‰¹å¾ï¼ŒåŒ…æ‹¬é€šè¿‡å°†å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶åç¼–è¯‘ä¸ºæºä»£ç è·å¾—çš„ç‰¹å¾ã€‚é‡‡ç”¨äº†ä¸€å¥—æ¥è‡ªæºä»£ç ä½œè€…å½’å±é¢†åŸŸçš„å¼ºå¤§æŠ€æœ¯ï¼Œä»¥åŠæ±‡ç¼–ä¸­åµŒå…¥çš„é£æ ¼è¡¨ç¤ºï¼ŒæˆåŠŸåœ°å®ç°äº†å¤§é‡ç¨‹åºå‘˜çš„å»åŒ¿ååŒ–ã€‚**
åœ¨è°·æ­Œä»£ç é˜»å¡çš„æ•°æ®ä¸Šè¯„ä¼°äº†æ‰€æå‡ºæ–¹æ³•ï¼Œåœ¨100åå’Œ600åå€™é€‰ç¨‹åºå‘˜ä¸­è·å¾—äº†é«˜è¾¾96%çš„å½’å› å‡†ç¡®ç‡ã€‚æœ¬æ–‡é¦–æ¬¡æå‡ºä¸€ç§å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶ä½œè€…å½’å±æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯¹åŸºæœ¬çš„æ··æ·†ã€ä¸€ç³»åˆ—ç¼–è¯‘å™¨ä¼˜åŒ–è®¾ç½®å’Œå»æ‰ç¬¦å·è¡¨çš„äºŒè¿›åˆ¶æ–‡ä»¶å…·æœ‰é²æ£’æ€§ã€‚æˆ‘ä»¬ä½¿ç”¨æ··æ·†çš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œåœ¨å•ä½œè€…GitHubä»“åº“å’Œæœ€è¿‘æ³„éœ²çš„è¿™ä¸ªhttp URLé»‘å®¢è®ºå›ä¸­æ‰¾åˆ°çš„çœŸå®ä¸–ç•Œçš„ä»£ç æ¥æ‰§è¡Œç¨‹åºå‘˜å»åŒ¿ååŒ–ã€‚ç ”ç©¶è¡¨æ˜ï¼Œæƒ³è¦ä¿æŒåŒ¿åçš„ç¨‹åºå‘˜éœ€è¦é‡‡å–æç«¯çš„å¯¹ç­–æ¥ä¿æŠ¤ä»–ä»¬çš„éšç§ã€‚

### å…·ä½“

**é—®é¢˜æè¿°**

åˆ†æäººå‘˜æ ¹æ®çº¯ç²¹çš„äºŒè¿›åˆ¶ç¨‹åºé£æ ¼æ¥ç¡®å®šå…¶ç¨‹åºå‘˜ï¼Œç¨‹åºå‘˜é›†åˆå·²çŸ¥ä¸”å¯¹åº”æ ·æœ¬ï¼Œæ‰€ä»¥æ˜¯ä¸€ä¸ªå°é—­ä¸–ç•Œçš„æœ‰ç›‘ç£æœºå™¨å­¦ä¹ é—®é¢˜

**æ–¹æ³•**

åæ±‡ç¼–ï¼šè·å¾—åŸºäºæŒ‡ä»¤ç ï¼Œå­—ç¬¦ä¸²ï¼Œç¬¦å·ä¿¡æ¯å’Œæ§åˆ¶æµå›¾çš„ç‰¹å¾

åç¼–è¯‘ï¼šç¿»è¯‘æˆä¼ªcä»£ç ï¼Œè·å¾—è¯­æ³•æŠ½è±¡æ ‘ï¼Œå¹¶ä»ä¸­æå–è¯­æ³•ç‰¹å¾å’Œn-grams

é™ç»´ï¼šæœ‰äº†æ¥è‡ªåæ±‡ç¼–å™¨å’Œåç¼–è¯‘å™¨çš„ç‰¹å¾ï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨åŸºäºä¿¡æ¯å¢ç›Šå’Œç›¸å…³æ€§ç‰¹å¾é€‰æ‹©çš„æ ‡å‡†ç‰¹å¾é€‰æ‹©æŠ€æœ¯ï¼Œé€‰å‡ºå…¶ä¸­å¯¹åˆ†ç±»ç‰¹åˆ«æœ‰ç”¨çš„ç‰¹å¾ã€‚ï¼ˆå› ä¸ºå¤§é‡çš„ç‰¹å¾ä¸èƒ½ä»£è¡¨ç¨‹åºå‘˜é£æ ¼ï¼Œæ‰€ä»¥éœ€è¦é€‰æ‹©ç‰¹å¾ï¼Œå‡å°‘åˆ†ç±»è®¡ç®—è¿‡ç¨‹ä¸­è®¡ç®—è´Ÿæ‹…ä¸è¿‡æ‹Ÿåˆçš„å¯èƒ½ï¼‰ã€‚

- ä½¿ç”¨ [WEKA çš„ä¿¡æ¯å¢ç›Šå±æ€§é€‰æ‹©å‡†åˆ™](https://www.cms.waikato.ac.nz/~ml/publications/2009/weka_update.pdf) ã€‚

- ç‰¹å¾é€‰æ‹©ï¼šè¯¥é€‰æ‹©æ–¹æ³•é€šè¿‡è€ƒè™‘æ¯ä¸ªç‰¹å¾çš„å•ç‹¬é¢„æµ‹èƒ½åŠ›ä»¥åŠå®ƒä»¬ä¹‹é—´çš„å†—ä½™ç¨‹åº¦æ¥è¯„ä¼°å±æ€§å­é›†çš„ä»·å€¼ã€‚ç‰¹å¾é€‰æ‹©é€šè¿‡**è´ªå©ªçˆ¬å¡å’Œå›æº¯èƒ½åŠ›è¿­ä»£è¿›è¡Œï¼Œå°†ä¸ç±»ç›¸å…³æ€§æœ€é«˜çš„å±æ€§æ·»åŠ åˆ°æ‰€é€‰ç‰¹å¾åˆ—è¡¨ä¸­**ã€‚

> WEKA çš„ä¿¡æ¯å¢ç›Šå±æ€§é€‰æ‹©å‡†åˆ™ï¼šè¯„ä¼°äº†ç»™å®šç‰¹å®šç‰¹å¾çš„ç±»åˆ«åˆ†å¸ƒç†µä¸ç±»åˆ«æ¡ä»¶åˆ†å¸ƒé¦™å†œç†µä¹‹é—´çš„å·®å¼‚ [36]ã€‚

> è¿‡æ‹Ÿåˆçš„ä¾‹å­ï¼šä¸€ä¸ªç½•è§çš„æ±‡ç¼–æŒ‡ä»¤å¯èƒ½å¯¹åº”ä¸€ä¸ªä½œè€…ï¼Œè¿™æ˜¯ä¸å‡†ç¡®çš„

åˆ†ç±»ï¼šæœ€ååœ¨ç›¸åº”çš„ç‰¹å¾å‘é‡ä¸Šè®­ç»ƒæ£®æ—åˆ†ç±»å™¨ã€‚ä½¿ç”¨[éšæœºæ£®æ—åˆ†ç±»å™¨](https://zhuanlan.zhihu.com/p/471494060)ã€‚

![image-20230814181423841](https://raw.githubusercontent.com/Military-axe/imgtable/main/202308191555888.png)

## Cross-architecture bug search in binary executables.[^9]

tag: `2015`ï¼Œ`åµŒå…¥å¼`ï¼Œ`CCF-A`

### æ‘˜è¦

éšç€å„ç§ CPU æ¶æ„çš„é—­æºè½¯ä»¶çš„æ™®éå¯ç”¨æ€§ï¼Œéœ€è¦åœ¨äºŒè¿›åˆ¶çº§åˆ«è¯†åˆ«å®‰å…¨å…³é”®æ¼æ´ï¼Œä»¥æ‰§è¡Œæ¼æ´è¯„ä¼°ã€‚é—æ†¾çš„æ˜¯ï¼Œç°æœ‰çš„æ¼æ´æŸ¥æ‰¾æ–¹æ³•å­˜åœ¨ä»¥ä¸‹ä¸è¶³ï¼ši) éœ€è¦æºä»£ç ï¼›ii) ä»…é€‚ç”¨äºå•ä¸€ä½“ç³»ç»“æ„ï¼ˆé€šå¸¸ä¸º x86ï¼‰ï¼›iii) ä¾èµ–äºåŠ¨æ€åˆ†æï¼Œè€ŒåŠ¨æ€åˆ†æå¯¹äºåµŒå…¥å¼è®¾å¤‡æ¥è¯´æœ¬èº«å°±å¾ˆå›°éš¾ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†**ä¸€ç§ä¸ºå·²çŸ¥æ¼æ´æå–æ¼æ´ç­¾åçš„ç³»ç»Ÿ**ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™äº›ç­¾åæ¥æŸ¥æ‰¾éƒ¨ç½²åœ¨ä¸åŒ CPU ä½“ç³»ç»“æ„ï¼ˆå¦‚ x86 ä¸ MIPSï¼‰ä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„é”™è¯¯ã€‚CPU ä½“ç³»ç»“æ„çš„å¤šæ ·æ€§å¸¦æ¥äº†è®¸å¤šæŒ‘æˆ˜ï¼Œä¾‹å¦‚ CPU æ¨¡å‹ä¹‹é—´æŒ‡ä»¤é›†ä½“ç³»ç»“æ„çš„ä¸å¯æ¯”æ€§ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆå°†äºŒè¿›åˆ¶ä»£ç è½¬æ¢ä¸ºä¸­é—´è¡¨ç¤ºå½¢å¼ï¼Œä»è€Œå¾—åˆ°å¸¦æœ‰è¾“å…¥å’Œè¾“å‡ºå˜é‡çš„èµ‹å€¼å…¬å¼ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯¹å…·ä½“è¾“å…¥è¿›è¡Œé‡‡æ ·ï¼Œè§‚å¯ŸåŸºæœ¬æ¨¡å—çš„ I/O è¡Œä¸ºï¼Œä»è€ŒæŒæ¡å®ƒä»¬çš„è¯­ä¹‰ã€‚æœ€åï¼Œæˆ‘ä»¬åˆ©ç”¨ I/O è¡Œä¸ºæ‰¾åˆ°ä¸æ¼æ´ç‰¹å¾è¡Œä¸ºç±»ä¼¼çš„ä»£ç éƒ¨åˆ†ï¼Œä»è€Œæœ‰æ•ˆåœ°æ­ç¤ºå‡ºåŒ…å«æ¼æ´çš„ä»£ç éƒ¨åˆ†ã€‚æˆ‘ä»¬è®¾è®¡å¹¶å®ç°äº†ä¸€ç§åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸­è¿›è¡Œè·¨æ¶æ„é”™è¯¯æœç´¢çš„å·¥å…·ã€‚æˆ‘ä»¬çš„åŸå‹ç›®å‰æ”¯æŒä¸‰ç§æŒ‡ä»¤é›†ä½“ç³»ç»“æ„ï¼ˆx86ã€ARM å’Œ MIPSï¼‰ï¼Œå¹¶èƒ½åœ¨è¿™äº›ä½“ç³»ç»“æ„ä¸­çš„ä»»ä½•ä¸€ç§ä¸­å‘ç°äºŒè¿›åˆ¶ä»£ç ä¸­çš„æ¼æ´ã€‚æˆ‘ä»¬çš„ç ”ç©¶è¡¨æ˜ï¼Œæ— è®ºåº•å±‚è½¯ä»¶æŒ‡ä»¤é›†æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬éƒ½èƒ½æ‰¾åˆ°å¿ƒè„å‡ºè¡€æ¼æ´ã€‚åŒæ ·ï¼Œæˆ‘ä»¬è¿˜åº”ç”¨æˆ‘ä»¬çš„æ–¹æ³•åœ¨åŸºäº MIPS å’Œ ARM çš„è·¯ç”±å™¨çš„å°é—­æºå›ºä»¶é•œåƒä¸­å‘ç°äº†åé—¨ã€‚

### å…·ä½“

**å·¥ä½œæµç¨‹**

ä½¿ç”¨æ¼æ´ç­¾åï¼Œå³ä¸€æ®µä¸æ¼æ´ç±»ç‰¹å®šå®ä¾‹ç›¸ä¼¼çš„äºŒè¿›åˆ¶ä»£ç ï¼Œæ¥å‘ç°å¦ä¸€ä¸ªäºŒè¿›åˆ¶ç¨‹åºï¼ˆç›®æ ‡ç¨‹åºï¼‰ä¸­å¯èƒ½å­˜åœ¨çš„æ¼æ´ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆæ¨å¯¼å‡ºæ¼æ´ç­¾åã€‚ç„¶åï¼Œæˆ‘ä»¬å°†æ¼æ´ç­¾åå’Œç›®æ ‡ç¨‹åºéƒ½è½¬æ¢æˆä¸­é—´è¡¨ç¤ºï¼Œå¹¶æ„å»ºç´§å‡‘çš„åŸºæœ¬åˆ†å—è¯­ä¹‰å“ˆå¸Œå€¼ã€‚æ‰€æœ‰è¿™äº›è½¬æ¢å¯¹äºé”™è¯¯ç­¾åå’Œç›®æ ‡ç¨‹åºæ¥è¯´éƒ½æ˜¯ä¸€æ¬¡æ€§è¿‡ç¨‹ã€‚

é¦–å…ˆå°†æ±‡ç¼–ä»£ç è½¬åŒ–ä¸ºä¸­é—´è¡¨ç¤ºï¼Œå¾—åˆ°ä¸€ä¸ªæ˜“äºè§£æçš„ç¬¦å·è¡¨è¾¾å¼ï¼Œç„¶åé€šè¿‡éšæœºè¾“å…¥å€¼ï¼Œå¯¹è¿™äº›è¡¨è¾¾å¼é‡‡æ ·ï¼Œå¾—åˆ°IOå¯¹ï¼Œæœ€åå¯¹IOå¯¹ç®€å†hashå€¼ã€‚è¿™æ ·å°±èƒ½å¯¹æ¯”åŸºæœ¬çš„IOåŠŸèƒ½

![image-20230815120048492](https://raw.githubusercontent.com/Military-axe/imgtable/main/202308191555547.png)

åœ¨æœç´¢é˜¶æ®µï¼Œæˆ‘ä»¬ä½¿ç”¨è½¬æ¢åçš„æ¼æ´ç­¾åï¼ˆå³å…¶èµ‹å€¼å…¬å¼å›¾ï¼‰æ¥è¯†åˆ«ç±»ä¼¼è½¬æ¢äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„é”™è¯¯ã€‚è¦åœ¨ç›®æ ‡ç¨‹åºä¸­ä¸ºé”™è¯¯ç‰¹å¾çš„æ‰€æœ‰å•ä¸ªåŸºæœ¬æ¨¡å—å¯»æ‰¾æœ‰å¸Œæœ›çš„åŒ¹é…å€™é€‰å¯¹è±¡ã€‚å¯¹äºæ¯ä¸€å¯¹è¿™æ ·çš„å€™é€‰å¯¹è±¡ï¼Œæˆ‘ä»¬éƒ½ä¼šåº”ç”¨ä¸€ç§ **åŸºäºCFG çš„ã€è´ªå©ªä½†å±€éƒ¨æœ€ä¼˜çš„æ‹“å®½ç®—æ³•**ã€‚è¯¥ç®—æ³•ä½¿ç”¨é”™è¯¯ç‰¹å¾å’Œç›®æ ‡ç¨‹åºä¸­çš„å…¶ä»–åŸºæœ¬å—æ¥æ‰©å±•åˆå§‹åŒ¹é…ã€‚

æ¼æ´ç­¾ååŒ¹é…ç®—æ³•BHB(Best-Hit-Broadening)

BHB çš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š ç»™å®šä¸€å¯¹èµ·ç‚¹ï¼ˆç­¾åä¸­çš„åŸºæœ¬æ¨¡å—å’Œç›®æ ‡ç¨‹åºä¸­ä¸ä¹‹åŒ¹é…çš„å€™é€‰æ¨¡å—ï¼‰åï¼Œå®ƒé¦–å…ˆæ²¿ç€å„è‡ªçš„ CFG æ¢ç´¢è¿™äº›åŸºæœ¬æ¨¡å—çš„é‚»è¿‘åŒºåŸŸã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œå®ƒä¸¥æ ¼åŒºåˆ†äº†å‰å‘å’Œåå‘ã€‚

![image-20230816140415715](https://raw.githubusercontent.com/Military-axe/imgtable/main/202308191554698.png)

é€šè¿‡hashå€¼ç¡®å®šç›¸ä¼¼åº¦é‡ï¼Œè¯„ä¼°å¤§é‡é‡‡æ ·ä¼šç”Ÿæˆå¾ˆå¤šIOå¯¹ï¼ŒåŒ¹é…ç›¸åŒçš„hashå€¼è¶Šå¤šï¼Œè¯´æ˜ç›¸ä¼¼åº¦è¶Šé«˜ã€‚

## BinGo: cross-architecture cross-OS binary search[^10]

tag: `2016`, `å†…è”å‡½æ•°æ•è·å®Œæ•´è¯­ä¹‰`ï¼Œ`é•¿åº¦è½¨è¿¹è·Ÿè¸ª`ï¼Œ`CCF-A`

### æ‘˜è¦

æœ€è¿‘ï¼ŒäºŒè¿›åˆ¶ä»£ç æœç´¢å› å…¶åœ¨å‰½çªƒæ£€æµ‹ã€æ¶æ„è½¯ä»¶æ£€æµ‹å’Œè½¯ä»¶æ¼æ´å®¡è®¡ç­‰æ–¹é¢çš„é‡è¦åº”ç”¨è€Œå¤‡å—å…³æ³¨ã€‚ç„¶è€Œï¼Œç”±äºä¸åŒç¼–è¯‘å™¨ã€ä½“ç³»ç»“æ„å’Œæ“ä½œç³»ç»Ÿå¯¼è‡´äºŒè¿›åˆ¶æ–‡ä»¶åœ¨è¯­æ³•å’Œç»“æ„ä¸Šå­˜åœ¨å·¨å¤§å·®å¼‚ï¼Œå› æ­¤å¼€å‘æœ‰æ•ˆçš„äºŒè¿›åˆ¶ä»£ç æœç´¢å·¥å…·å…·æœ‰å¾ˆå¤§çš„æŒ‘æˆ˜æ€§ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº† BINGO--ä¸€ä¸ªå¯æ‰©å±•çš„ã€å¼ºå¤§çš„äºŒè¿›åˆ¶æœç´¢å¼•æ“ï¼Œæ”¯æŒå„ç§ä½“ç³»ç»“æ„å’Œæ“ä½œç³»ç»Ÿã€‚å…¶ä¸»è¦è´¡çŒ®åœ¨äºé‡‡ç”¨é€‰æ‹©æ€§å†…è”æŠ€æœ¯ï¼Œé€šè¿‡å†…è”ç›¸å…³åº“å‡½æ•°å’Œç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°æ¥æ•æ‰å®Œæ•´çš„å‡½æ•°è¯­ä¹‰ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜æå‡ºäº†æ¶æ„å’Œæ“ä½œç³»ç»Ÿä¸­æ€§å‡½æ•°è¿‡æ»¤æŠ€æœ¯ï¼Œä»¥æ˜¾è‘—å‡å°‘ä¸ç›¸å…³çš„ç›®æ ‡å‡½æ•°ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¼•å…¥äº†é•¿åº¦å˜é‡éƒ¨åˆ†è·Ÿè¸ªï¼Œä»¥ç¨‹åºç»“æ„æ— å…³çš„æ–¹å¼å¯¹äºŒè¿›åˆ¶å‡½æ•°è¿›è¡Œå»ºæ¨¡ã€‚å®éªŒç»“æœè¡¨æ˜ï¼Œå³ä½¿å­˜åœ¨ç¨‹åºç»“æ„å¤±çœŸï¼ŒBINGO ä¹Ÿèƒ½ä»¥å¯æ‰©å±•çš„æ–¹å¼æ‰¾åˆ°è·¨è¶Šæ¶æ„å’Œæ“ä½œç³»ç»Ÿè¾¹ç•Œçš„è¯­ä¹‰ç›¸ä¼¼å‡½æ•°ã€‚åˆ©ç”¨ BINGOï¼Œæˆ‘ä»¬è¿˜å‘ç°äº† Adobe PDF Readerï¼ˆä¸€ç§ COTS äºŒè¿›åˆ¶è½¯ä»¶ï¼‰ä¸­çš„é›¶æ—¥æ¼æ´ã€‚

### å…·ä½“

é’ˆå¯¹ä¸‰ä¸ªå›°éš¾ç‚¹ï¼š

1. æ¶æ„ï¼Œç¼–è¯‘å™¨ï¼Œæ“ä½œç³»ç»Ÿå·®å¼‚å¸¦æ¥çš„è¯­æ³•å’Œç»“æ„å·®å¼‚ã€‚ï¼ˆæ¯”å¦‚memcpyåœ¨gccä¸‹å’Œmingwä¸‹ç¼–è¯‘å·®å¼‚å·¨å¤§ï¼Œä¸€ä¸ªæ²¡æœ‰å†…è”ï¼Œä¸€ä¸ªä¼šå†…è”ï¼›ï¼‰
2. é€šè¿‡è€ƒè™‘å®Œæ•´çš„å‡½æ•°è¯­ä¹‰æ¥å®ç°ç²¾ç¡®æ€§ã€‚
3. å¯æ‹“å±•è‡³å¤§å‹çœŸå®äºŒè¿›åˆ¶æ–‡ä»¶ã€‚

<img src="https://raw.githubusercontent.com/Military-axe/imgtable/main/202308191554427.png" alt="image-20230816210021713" style="zoom:67%;" />

BinGoä¼šé¦–å…ˆå†…è”æ‰€æœ‰åº“å’Œç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼ˆæ•è·å®Œæ•´è¯­ä¹‰ï¼‰ï¼Œç„¶åé€‰æ‹©æ€§å‰ªæï¼ˆå›¾2Trace Pruningï¼‰æ¥å‡å°‘è·¯å¾„ï¼Œé¿å…è·¯å¾„çˆ†ç‚¸ã€‚é’ˆå¯¹å›°éš¾2ï¼Œæå‡ºäº†ä¸€ä¸ªä¸“é—¨çš„é€‰æ‹©å†…è”ç®—æ³•ã€‚

å°†æ±‡ç¼–ä»£ç è½¬åŒ–ä¸ºIRï¼ˆä¸­é—´ä»£ç ï¼‰æ¥åšåˆ°æ‹“å±•æ€§ã€‚è®¾å®šäº†è¿‡æ»¤å™¨ï¼Œå¯ä»¥åœ¨åŒ¹é…ä¹‹å‰å»é™¤å¤§é‡ä¸ç›¸å…³çš„å‡½æ•°ã€‚è®¾å®šäº†ä¸€ä¸ªå‡½æ•°è¿‡æ»¤ç®—æ³•ï¼Œç›®çš„æ˜¯å‡å°‘åŒ¹é…çš„å‡½æ•°ï¼Œæé«˜æ•ˆç‡ã€‚é’ˆå¯¹å›°éš¾3ã€‚

æå–ç¨‹åºçš„é•¿åº¦å˜é‡éƒ¨åˆ†è½¨è¿¹ï¼Œåœ¨ä¸åŒæ°´å¹³å±‚é¢å¯¹å‡½æ•°å»ºæ¨¡ï¼ˆä¸åº•å±‚æ¶æ„æ— å…³ï¼‰ã€‚ä¹‹åå¯ä»¥ä»å‡½æ•°æ¨¡å‹ä¸­æå–å‡½æ•°è¯­ä¹‰ç”¨äºå‡½æ•°ç›¸ä¼¼æ€§è¯„åˆ†ã€‚é’ˆå¯¹çš„æ˜¯å›°éš¾1ï¼Œä¸‹å›¾æ˜¯æå–é•¿åº¦éƒ¨åˆ†ï¼Œæå–é•¿åº¦çš„ç®—æ³•æ˜¯ç”¨2014å¹´çš„[Davidçš„è®ºæ–‡](https://csaws.cs.technion.ac.il/~yahave/papers/pldi14-tracelets.pdf)

<img src="https://raw.githubusercontent.com/Military-axe/imgtable/main/202308191554831.png" alt="image-20230816213030895" style="zoom:80%;" />



**è¯­ä¹‰æå–**

æå–éƒ¨åˆ†é•¿åº¦è½¨è¿¹åï¼Œå¯ä»¥ä»ä¸­æå–è¯­ä¹‰ï¼Œæå–ä¸‰å…ƒç»„\\(<mem,reg,flag>\\)ï¼ˆå†…å­˜ï¼Œå¯„å­˜å™¨ï¼Œæ¡ä»¶è·³è½¬ä½ï¼‰ã€‚ä¸»è¦æ•æ‰3å…ƒç»„å‰åå˜åŒ–çŠ¶æ€ä¹‹é—´çš„å…³ç³»ã€‚å¯ä»¥ä½¿ç”¨çº¦æŸæ±‚è§£ï¼ˆZ3ï¼‰æ¥åˆ¤æ–­è¯­ä¹‰ç›¸ä¼¼åº¦ï¼Œä½†æ˜¯çœŸå®ä¸–ç•Œä½¿ç”¨ä»£ä»·å·¨å¤§ï¼Œæ‰€ä»¥å¼•å…¥äº†æœºå™¨å­¦ä¹ ã€‚

> åœ¨è½¨è¿¹å‰ªæçš„éƒ¨åˆ†ï¼Œè¿˜æ˜¯ç”¨åˆ°äº†çº¦æŸæ±‚è§£æ¥å»é™¤ä¸€äº›ä¸å¯åˆ°è¾¾çš„åˆ†æ”¯

**åŠŸèƒ½åŒ¹é…**

åˆ©ç”¨ä¸åŒçš„é•¿åº¦è½¨è¿¹çº¿æ¥å»ºæ¨¡å‡½æ•°ï¼Œåˆ†3ä¸­ç²’åº¦ï¼ˆ1ï¼Œ2ï¼Œ3ï¼‰ï¼Œæ‰€æœ‰è½¨è¿¹çº¿å…±åŒç»„æˆå‡½æ•°æ¨¡å‹ã€‚é’ˆå¯¹ä¸‹å›¾ä¸ºä¾‹åšè§£é‡Š

<img src="https://raw.githubusercontent.com/Military-axe/imgtable/main/202308191554585.png" alt="image-20230816215552603" style="zoom:50%;" />

å‡½æ•°æ¨¡å‹çš„ç­¾åä¸º\\(M_{sig} = \{<1>,<2>,...,<1,2>,<2,5>,...,<1,2,4>,<2,4,7>\}\\)

å‡½æ•°æ¨¡å‹çš„ç›®æ ‡ä¸º\\(M_{tar}=\{<c>,<b>,...,<a,b>,<b,c>,...,<a,b,c>,<b,c,f>\}\\)

æ”¯æŒn-to-m,1-to-1,1-to-n,n-to-1,1-to-1çš„åŒ¹é…ã€‚è®¡ç®—ç›¸ä¼¼åº¦å…¬å¼å¦‚ä¸‹
$$
sim(M_{sig}, M_{tar}) = \frac{M_{sig}\cap M_{tar}}{M_{sig}}
$$


## Statistical similarity of binaries.[^11]

tag: `2016`ï¼Œ`CCF-A`ï¼Œ`åˆ†è§£æˆæ›´å°çš„è¯­ä¹‰é“¾`

### æ‘˜è¦

æˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜æ˜¯åœ¨å‰¥ç¦»çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ‰¾åˆ°ç›¸ä¼¼çš„ç¨‹åºã€‚æˆ‘ä»¬æå‡ºäº†ä¸€ç§æ–°çš„ç»Ÿè®¡æ–¹æ³•æ¥æµ‹é‡ä¸¤ä¸ªç¨‹åºä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚æˆ‘ä»¬çš„ç›¸ä¼¼æ€§æ¦‚å¿µä½¿æˆ‘ä»¬å³ä½¿åœ¨ä½¿ç”¨ä¸åŒç¼–è¯‘å™¨ç¼–è¯‘æˆ–ä¿®æ”¹è¿‡ä»£ç çš„æƒ…å†µä¸‹ä¹Ÿèƒ½æ‰¾åˆ°ç›¸ä¼¼ä»£ç ã€‚æˆ‘ä»¬çš„ä¸»è¦æ€è·¯æ˜¯é€šè¿‡ç»„åˆä½¿ç”¨ç›¸ä¼¼æ€§ï¼šå°†ä»£ç åˆ†è§£ä¸ºæ›´å°çš„å¯æ¯”è¾ƒç‰‡æ®µï¼Œå®šä¹‰ç‰‡æ®µä¹‹é—´çš„è¯­ä¹‰ç›¸ä¼¼æ€§ï¼Œå¹¶ä½¿ç”¨ç»Ÿè®¡æ¨ç†å°†ç‰‡æ®µç›¸ä¼¼æ€§æå‡ä¸ºç¨‹åºä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚æˆ‘ä»¬åœ¨ä¸€ä¸ªåä¸º Esh çš„å·¥å…·ä¸­å®ç°äº†æˆ‘ä»¬çš„æ–¹æ³•ï¼Œå¹¶å°†å…¶åº”ç”¨äºæŸ¥æ‰¾å„ç§è·¨ç¼–è¯‘å™¨å’Œç‰ˆæœ¬çš„çªå‡ºæ¼æ´ï¼ŒåŒ…æ‹¬ Heartbleedã€Shellshock å’Œ Venomã€‚æˆ‘ä»¬çš„ç ”ç©¶è¡¨æ˜ï¼ŒEsh çš„ç»“æœå‡†ç¡®ç‡å¾ˆé«˜ï¼Œå‡ ä¹æ²¡æœ‰è¯¯æŠ¥--è¿™å¯¹äºåœ¨å‰¥ç¦»çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­è¿›è¡Œæ¼æ´æœç´¢æ¥è¯´æ˜¯ä¸€ä¸ªè‡³å…³é‡è¦çš„å› ç´ ã€‚

### å…·ä½“

ä»å›¾ç›¸ä¼¼æ€§æ¥çš„æ€è·¯ï¼Œcï¼Œeä¸¤ä¸ªä»£ç æ¥è‡ªopensslä¸åŒç¼–è¯‘å™¨çš„ç»“æœï¼Œdæ˜¯æ— å…³ä»£ç ã€‚å°†ç›®æ ‡ä»£ç åˆ†å‰²æˆæ›´å°çš„é“¾ï¼Œé€šè¿‡å¯¹æ¯”é“¾çš„ç›¸ä¼¼åº¦æ¨å¹¿åˆ°æ›´å¤§éƒ¨åˆ†çš„ç›¸ä¼¼åº¦

<img src="https://raw.githubusercontent.com/Military-axe/imgtable/main/202308191554644.png" alt="image-20230817140805611" style="zoom:80%;" />

**åˆæˆç›¸ä¼¼æ€§**

å°†ç¨‹åºåˆ†è§£æˆè¾ƒå°çš„ç‰‡æ®µï¼Œç§°ä¹‹ä¸ºâ€œé“¾â€ï¼Œè¿™äº›â€œé“¾â€æ¥è¿›è¡Œæ¯”è¾ƒã€‚

æ¯”è¾ƒé“¾ä½¿ç”¨â€œç¨‹åºéªŒè¯å™¨â€ï¼Œä¼ å…¥ç›¸åŒçš„è¾“å…¥æ¥æ£€æŸ¥ä¸­é—´å€¼å’Œè¾“å‡ºå€¼æ˜¯å¦ç›¸åŒï¼Œä¸ç­‰åŒæ—¶ä¼šæ ¹æ®åŒ¹é…å€¼å æ€»å­—ç¬¦ä¸²æ€»å€¼æ¥ç»Ÿè®¡æ¨ç†ã€‚

æå‡ºäº†ä¸€ä¸ªç»Ÿè®¡æ¨ç†ç®—æ³•ï¼Œèƒ½æ ¹æ®é“¾ç›¸ä¼¼æ€§æ¨ç†æ•´ä¸ªç¨‹åºçš„çš„ç›¸ä¼¼æ€§ã€‚

å¯¹æ¯”ä¸¤æ¡é“¾çš„æ­¥éª¤

- ä¸ºä¸¤æ¡é“¾æ·»åŠ ç­‰ä»·å‡è®¾
- ä¸‹æ–­è¨€ï¼Œæ£€æŸ¥æ‰€æœ‰è¾“å‡ºå˜é‡çš„ç›¸ç­‰æ€§
- ä½¿ç”¨ç¨‹åºéªŒè¯å™¨æ£€æŸ¥æ–­è¨€ï¼Œå¹¶è®¡ç®—æœ‰å¤šå°‘å˜é‡æ˜¯ç­‰ä»·çš„ã€‚

> åœ¨å‡è®¾å’Œæ–­è¨€ç›¸ç­‰æ—¶ï¼Œé€‰æ‹©å°†å“ªäº›å˜é‡é…å¯¹æ˜¯é€šè¿‡æœç´¢å¯èƒ½é…å¯¹çš„ç©ºé—´æ¥è§£å†³çš„ã€‚é€‰æ‹©è‚¡ä½œä¸ºä¸€ä¸ªå°çš„æ¯”è¾ƒå•ä½ï¼ˆå˜é‡æ•°é‡ç›¸å¯¹è¾ƒå°‘ï¼‰ï¼Œå†åŠ ä¸ŠåŸºäº**éªŒè¯å™¨çš„ä¼˜åŒ–**ï¼Œå¯ä»¥å¤§å¤§ç¼©å°æœç´¢ç©ºé—´ï¼Œä»è€Œä½¿éªŒè¯å™¨çš„ä½¿ç”¨å˜å¾—å¯è¡Œã€‚

## discovRE: Efficient Cross-Architecture Identification of Bugs in Binary Code[^12]

tag: `2016`ï¼Œ`CCF-B/NDSS`ï¼Œ`åŸºäºæ•°å­—ç‰¹å¾è¿‡æ»¤`ï¼Œ`kNN`ï¼Œ`MCSè¿‘ä¼¼è§£`

### æ‘˜è¦

è¯†åˆ«å®‰å…¨å…³é”®æ¼æ´æ˜¯ä¿æŠ¤è®¡ç®—æœºç³»ç»Ÿçš„å…³é”®ã€‚ç”±äºè®¸å¤šè½¯ä»¶é¡¹ç›®éƒ½æ˜¯é—­æºçš„ï¼Œå› æ­¤èƒ½å¤Ÿåœ¨äºŒè¿›åˆ¶çº§åˆ«æ‰§è¡Œè¿™ä¸€è¿‡ç¨‹æ˜¯éå¸¸é‡è¦çš„ã€‚å³ä½¿æºä»£ç æ˜¯å¯ç”¨çš„ï¼Œç¼–è¯‘ä¹Ÿå¯èƒ½é€ æˆæºä»£ç ä¸å¤„ç†å™¨æ‰§è¡Œçš„äºŒè¿›åˆ¶ä»£ç ä¹‹é—´çš„ä¸åŒ¹é…ï¼Œå¯¼è‡´å¯¹æºä»£ç è¿›è¡Œçš„åˆ†ææ— æ³•æ£€æµ‹åˆ°æŸäº›é”™è¯¯ï¼Œä»è€Œå‘ç°æ½œåœ¨çš„æ¼æ´ã€‚åœ¨äºŒè¿›åˆ¶ä»£ç ä¸­æŸ¥æ‰¾æ¼æ´çš„ç°æœ‰æ–¹æ³•æœ‰ï¼š

1. ä½¿ç”¨åŠ¨æ€åˆ†æï¼Œè¿™å¯¹å›ºä»¶æ¥è¯´æ¯”è¾ƒå›°éš¾ï¼›

2. åªå¤„ç†å•ä¸€æ¶æ„ï¼›

3. ä½¿ç”¨è¯­ä¹‰ç›¸ä¼¼æ€§ï¼Œè¿™åœ¨åˆ†æå¤§å‹ä»£ç åº“æ—¶éå¸¸ç¼“æ…¢ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§åœ¨äºŒè¿›åˆ¶ä»£ç ä¸­é«˜æ•ˆæœç´¢ç›¸ä¼¼å‡½æ•°çš„æ–°æ–¹æ³•ã€‚æˆ‘ä»¬ä½¿ç”¨è¿™ç§æ–¹æ³•æ¥è¯†åˆ«äºŒè¿›åˆ¶ä»£ç ä¸­çš„å·²çŸ¥æ¼æ´ï¼Œå…·ä½“å¦‚ä¸‹ï¼šä»ä¸€ä¸ªæ˜“å—æ”»å‡»çš„äºŒè¿›åˆ¶å‡½æ•°å¼€å§‹ï¼Œæˆ‘ä»¬åœ¨ä¸åŒçš„ç¼–è¯‘å™¨ã€ä¼˜åŒ–çº§åˆ«ã€æ“ä½œç³»ç»Ÿå’Œ CPU ä½“ç³»ç»“æ„ä¸­è¯†åˆ«å…¶ä»–äºŒè¿›åˆ¶ä»£ç ä¸­çš„ç±»ä¼¼å‡½æ•°ã€‚å…¶ä¸»è¦æ€è·¯æ˜¯æ ¹æ®ç›¸åº”æ§åˆ¶æµå›¾çš„ç»“æ„è®¡ç®—å‡½æ•°ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚ä¸ºäº†å°½é‡å‡å°‘è¿™ç§æ˜‚è´µçš„è®¡ç®—ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†ä¸€ç§**åŸºäºæ•°å­—ç‰¹å¾çš„é«˜æ•ˆé¢„è¿‡æ»¤æ–¹æ³•ï¼Œä»¥å¿«é€Ÿè¯†åˆ«ä¸€å°éƒ¨åˆ†å€™é€‰å‡½æ•°**ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨å¤§å‹ä»£ç åº“ä¸­é«˜æ•ˆåœ°æœç´¢ç±»ä¼¼å‡½æ•°ã€‚æˆ‘ä»¬è®¾è®¡å¹¶å®ç°äº†ä¸€ç§åä¸º discovRE çš„æ–¹æ³•åŸå‹ï¼Œå®ƒæ”¯æŒå››ç§æŒ‡ä»¤é›†æ¶æ„ï¼ˆx86ã€x64ã€ARMã€MIPSï¼‰ã€‚æˆ‘ä»¬çš„ç ”ç©¶è¡¨æ˜ï¼Œåœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­è¿›è¡Œè·¨ä½“ç³»ç»“æ„é”™è¯¯æœç´¢æ—¶ï¼ŒdiscovRE æ¯”æœ€å…ˆè¿›çš„å­¦æœ¯æ–¹æ³•å¿«å››ä¸ªæ•°é‡çº§ã€‚æˆ‘ä»¬è¿˜è¡¨æ˜ï¼Œæˆ‘ä»¬èƒ½åœ¨å¤§çº¦ 80 æ¯«ç§’å†…è¯†åˆ«å‡º Android ç³»ç»Ÿæ˜ åƒä¸­çš„ Heartbleed å’Œ POODLE æ¼æ´ï¼Œè¯¥æ˜ åƒåŒ…å« 130,000 å¤šä¸ªåŸç”Ÿ ARM å‡½æ•°ã€‚

### å…·ä½“

åŸºäºæœºå™¨å­¦ä¹ ç®—æ³•å’Œå‡½æ•°çš„ä¸€äº›ç»Ÿè®¡ç‰¹å¾ä¿¡æ¯å’Œç»“æ„ä¿¡æ¯è¿›è¡Œå‡½æ•°å…³è”ç ”ç©¶å·¥ä½œï¼Œå®šä¹‰äº†ä¸€äº›å—ä¸åŒæ¶æ„å½±å“è¾ƒå°çš„ç‰¹å¾ï¼Œç„¶åç»™æ¯ä¸€ç§ç‰¹å¾èµ‹äºˆä¸€å®šæƒé‡ï¼Œæ ¹æ®æ•°å€¼ç‰¹å¾è¿‡æ»¤æ‰ç›¸å·®æ¯”è¾ƒå¤§çš„å€™é€‰å‡½æ•°ï¼Œç„¶åè®¡ç®—å‡½æ•°ä¹‹é—´çš„ç»“æ„ç›¸ä¼¼åº¦ï¼Œæœ€ç»ˆå¾—åˆ°å‡½æ•°ç›¸ä¼¼åº¦çš„æ’åã€‚å¯¹åŠ äº†æ··æ·†çš„æ•ˆæœå¾ˆå·®

**ç‰¹å¾**

ä»£ç åœ¨ä¸åŒç¼–è¯‘å™¨ï¼Œä¼˜åŒ–é€‰é¡¹ï¼Œæ“ä½œç³»ç»Ÿå’ŒCPUä½“ç³»ç»“æ„ä¸­ä»£ç ç‰¹å¾åˆ†ä¸¤ç§ï¼Œç»“æ„ç‰¹å¾ï¼Œæ•°å­—ç‰¹å¾ã€‚ç»“æ„ç‰¹å¾å°±æ˜¯å†…éƒ¨æ§åˆ¶æµçš„ç»“æ„ï¼Œç”±CFGè¡¨ç¤ºã€‚è¿™ç§ç‰¹å¾æ˜¯æœ€ç¨³å¥çš„ç‰¹å¾ï¼Œä½†æ˜¯è®¡ç®—æˆæœ¬é«˜ï¼Œä¸é€‚åˆæ¯”è¾ƒå¤§é‡å‡½æ•°ã€‚äºæ˜¯æœ¬æ–‡ç”¨ç¬¬äºŒç§ç‰¹å¾**æ•°å­—ç‰¹å¾**åšä¸ºè¡¥å……

æ•°å­—ç‰¹å¾ä»£è¡¨äºŒè¿›åˆ¶å‡½æ•°çš„å…ƒä¿¡æ¯ï¼ˆæŒ‡ä»¤æ•°ï¼ŒåŸºæœ¬æ¨¡å—æ•°ï¼Œå±€éƒ¨å˜é‡å¤§å°ï¼‰ï¼Œæ–‡ç« å°†æ•°å­—ç‰¹å¾åµŒå…¥å‘é‡ç©ºé—´ï¼Œåˆ©ç”¨æœºå™¨å­¦ä¹ ç®—æ³•æ¥æ ¹æ®ç‰¹å¾æŸ¥æ‰¾ç›¸ä¼¼å‡½æ•°ã€‚

> å¯¹æ··æ·†å·®çš„åŸå› å°±æ˜¯æ··æ·†ä¼šå¢åŠ æŒ‡ä»¤ä¸åŸºæœ¬å—ï¼Œç”šè‡³ä¼šæ”¹å˜åŸºæœ¬å—ç»“æ„ï¼Œéœ€è¦ç”¨å…¶ä»–æ–¹æ³•æå–

**ç³»ç»Ÿæ¶æ„**

é¦–å…ˆé€šè¿‡IDA proæ¥æå–æ•°å­—ç‰¹å¾ä¸ç»“æ„ç‰¹å¾

ç›¸ä¼¼æ€§è®¡ç®—åˆ†ä¸¤ä¸ªè¿‡æ»¤å™¨ï¼Œæ•°å­—è¿‡æ»¤å™¨ä¸ç»“æ„è¿‡æ»¤å™¨ï¼Œç²¾åº¦ä¾æ¬¡å¢é«˜ï¼Œè®¡ç®—å¤æ‚åº¦ä¹Ÿä¾æ¬¡å¢é«˜ã€‚æ‰€ä»¥å…ˆç”¨æ•°å­—è¿‡æ»¤å™¨ç­›é€‰ä¸€éƒ¨åˆ†å†è¿›å…¥ç»“æ„è¿‡æ»¤å™¨

**æ•°å­—ç‰¹å¾è¿‡æ»¤å™¨**

ä½¿ç”¨k-Nearest Neighborsç®—æ³•(kNN)æ¥æŸ¥æ‰¾ç›¸ä¼¼å‡½æ•°ï¼Œä¸ºäº†èƒ½æ¯”è¾ƒè‡ªå·±ç¡®å®šäº†ä¸€ç»„æ¯”è¾ƒä¸åŒæ¶æ„åŠŸèƒ½çš„ç‰¹å¾

**ç»“æ„ç‰¹å¾è¿‡æ»¤å™¨**

æ£€æŸ¥CFGä¸æ•°å­—è¿‡æ»¤å™¨çš„å€™é€‰å‡½æ•°é›†ï¼Œæå‡ºä¸€ç§åŸºäºæœ€å¤§å…¬å…±å­å›¾åŒæ„ï¼ˆMCSï¼‰çš„ç›¸ä¼¼åº¦é‡æ–¹æ³•ã€‚ï¼ˆæŒ‡å®šè¿­ä»£æ¬¡æ•°ï¼Œè¶…è¿‡æ¬¡æ•°åœæ­¢è¿­ä»£ï¼Œè¿”å›å½“å‰è®¡ç®—æœ€å°è·ç¦»ï¼‰

![image-20230818142932325](https://raw.githubusercontent.com/Military-axe/imgtable/main/202308191554479.png)

## Scalable graph-based bug search for firmware images. [^13]

tag: `2016`ï¼Œ`CCF-A`ï¼Œ`ACFG`ï¼Œ`é¢‘è°±èšç±»`

### æ‘˜è¦

ç”±äºç‰©è”ç½‘è®¾å¤‡å®‰å…¨æ¼æ´çŒ–ç—ï¼Œåœ¨å¤§è§„æ¨¡ç‰©è”ç½‘ç”Ÿæ€ç³»ç»Ÿä¸­æœç´¢æ¼æ´æ¯”ä»¥å¾€ä»»ä½•æ—¶å€™éƒ½æ›´åŠ é‡è¦ã€‚æœ€è¿‘çš„ç ”ç©¶è¡¨æ˜ï¼ŒåŸºäºæ§åˆ¶æµå›¾ï¼ˆCFGï¼‰çš„æ¼æ´æœç´¢æŠ€æœ¯å¯ä»¥åœ¨ä¸åŒæ¶æ„çš„ç‰©è”ç½‘è®¾å¤‡ä¸­æœ‰æ•ˆã€å‡†ç¡®åœ°æœç´¢æ¼æ´ã€‚ç„¶è€Œï¼Œè¿™äº›åŸºäº CFG çš„é”™è¯¯æœç´¢æ–¹æ³•ç”±äºå…¶æ˜‚è´µçš„å›¾åŒ¹é…å¼€é”€ï¼Œè¿œä¸èƒ½æ‰©å±•åˆ°å¤„ç†å¤§é‡é‡ç”Ÿç‰©è”ç½‘è®¾å¤‡ã€‚å—å›¾åƒå’Œè§†é¢‘æœç´¢é¢†åŸŸä¸°å¯Œç»éªŒçš„å¯å‘ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§æ–°çš„é”™è¯¯æœç´¢æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆè§£å†³äº†ç°æœ‰è·¨å¹³å°é”™è¯¯æœç´¢æŠ€æœ¯çš„å¯æ‰©å±•æ€§éš¾é¢˜ï¼Œå¹¶è¿›ä¸€æ­¥æé«˜äº†æœç´¢ç²¾åº¦ã€‚ä¸ç›´æ¥åŸºäºäºŒè¿›åˆ¶ä»£ç åŸå§‹ç‰¹å¾ï¼ˆCFGï¼‰è¿›è¡Œæœç´¢çš„ç°æœ‰æŠ€æœ¯ä¸åŒï¼Œæˆ‘ä»¬å°† CFG è½¬æ¢ä¸ºé«˜çº§æ•°å­—ç‰¹å¾å‘é‡ã€‚ä¸ CFG ç‰¹å¾ç›¸æ¯”ï¼Œé«˜çº§æ•°å­—ç‰¹å¾å‘é‡å¯¹ä¸åŒæ¶æ„çš„ä»£ç å˜åŒ–å…·æœ‰æ›´å¼ºçš„é²æ£’æ€§ï¼Œè€Œä¸”å¯ä»¥é€šè¿‡ä½¿ç”¨æœ€å…ˆè¿›çš„å“ˆå¸ŒæŠ€æœ¯è½»æ¾å®ç°å®æ—¶æœç´¢ã€‚æˆ‘ä»¬å®ç°äº†ä¸€ä¸ªé”™è¯¯æœç´¢å¼•æ“ Geniusï¼Œå¹¶å°†å…¶ä¸æœ€å…ˆè¿›çš„é”™è¯¯æœç´¢æ–¹æ³•è¿›è¡Œäº†æ¯”è¾ƒã€‚å®éªŒç»“æœè¡¨æ˜ï¼Œå¯¹äºå„ç§æŸ¥è¯¢è´Ÿè½½ï¼ŒGenius åœ¨é€Ÿåº¦å’Œå‡†ç¡®æ€§æ–¹é¢éƒ½ä¼˜äºåŸºå‡†æ–¹æ³•ã€‚æˆ‘ä»¬è¿˜åœ¨ä¸€ä¸ªç”± 33,045 å°è®¾å¤‡ç»„æˆçš„çœŸå®æ•°æ®é›†ä¸Šå¯¹ Genius è¿›è¡Œäº†è¯„ä¼°ï¼Œè¯¥æ•°æ®é›†æ˜¯ä»å…¬å…±èµ„æºå’Œæˆ‘ä»¬çš„ç³»ç»Ÿä¸­æ”¶é›†çš„ã€‚å®éªŒç»“æœè¡¨æ˜ï¼Œåœ¨å¯¹ 8,126 å¼ å›ºä»¶å›¾ç‰‡ï¼ˆåŒ…å« 420,558,702 ç§åŠŸèƒ½ï¼‰è¿›è¡Œæœç´¢æ—¶ï¼ŒGenius å¯ä»¥åœ¨å¹³å‡ 1 ç§’å†…å®Œæˆæœç´¢ã€‚é€šè¿‡åªæŸ¥çœ‹æœç´¢ç»“æœä¸­çš„å‰ 50 ä¸ªå€™é€‰å¯¹è±¡ï¼Œæˆ‘ä»¬å‘ç°äº† 5 ä¸ªä¾›åº”å•†çš„ 38 ä¸ªæ½œåœ¨æ¼æ´å›ºä»¶æ˜ åƒï¼Œå¹¶é€šè¿‡äººå·¥åˆ†æç¡®è®¤äº†å…¶ä¸­çš„ 23 ä¸ªã€‚æˆ‘ä»¬è¿˜å‘ç°ï¼Œåœ¨ D-LINK æœ€æ–°æ¨å‡ºçš„ä¸¤æ¬¾å•†ç”¨å›ºä»¶é•œåƒä¸­ï¼Œå¹³å‡åªéœ€ 0.1 ç§’å°±èƒ½æœç´¢å®Œæ‰€æœ‰ 154 ä¸ªæ¼æ´ã€‚è¿™äº›é•œåƒä¸­æœ‰ 103 ä¸ªæ½œåœ¨æ¼æ´ï¼Œå…¶ä¸­ 16 ä¸ªå·²è¢«ç¡®è®¤ã€‚

### å…·ä½“

è¯¥æ–¹æ³•åˆ©ç”¨ç»Ÿè®¡ç‰¹å¾æ„å»ºå‡½æ•°çš„ACFG(Attributed CFG),ç„¶åå°†è‹¥å¹²å‡½æ•°çš„ACFGè¿›è¡Œèšç±»ï¼Œå¾—åˆ°nä¸ªç±»å¿ƒï¼Œä½¿ç”¨ç±»å¿ƒå¯¹æ¯ä¸ªACFGè¿›è¡Œç¼–ç ï¼Œä½¿æ¯ä¸ªå‡½æ•°å¯¹åº”ä¸€ä¸ªç¼–ç å‘é‡ã€‚ç„¶ååˆ©ç”¨å‘é‡è®¡ç®—å‡½æ•°ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚è¯¥æ–¹æ³•è™½ç„¶å…·æœ‰å¯æ‰©å±•æ€§ï¼Œä½†æ˜¯ç¦»çº¿èšç±»ç®—æ³•æ—¶é—´è€—è´¹éå¸¸å¤§ã€‚

**ç‰¹å¾ç›¸ä¼¼æ€§å®šä¹‰**

å½’å±æ§åˆ¶æµå›¾(ACFG)æ˜¯ä¸€ä¸ªæœ‰å‘å›¾\\(G=<V, E, \varphi>\\)ï¼Œå¯ä»¥ç›´æ¥ç”¨ACFGå›¾æ¥è®¡ç®—ç›¸ä¼¼åº¦é‡ã€‚

**èšç±»**

ç”¨[é¢‘è°±èšç±»ç®—æ³•](https://proceedings.neurips.cc/paper_files/paper/2001/file/801272ee79cfde7fa5960571fee36b9b-Paper.pdf)ä½œä¸ºæ— ç›‘ç£å­¦ä¹ ç®—æ³•æ¥ç”Ÿæˆä»£ç é›†ï¼Œç”Ÿæˆä»£ç é›†çš„æˆæœ¬å¾ˆé«˜ï¼Œä¸è¿‡å¯ä»¥å‰æœŸå­¦ä¹ é˜¶æ®µç”Ÿæˆï¼Œå¯ä»¥ç”¨è¿‘ä¼¼èšç±»/åˆ†å±‚èšç±»ç®—æ³•æ¥åŠ å¿«

**ç‰¹å¾ç¼–ç **

ç‰¹å¾ç¼–ç å°±æ˜¯å°†åŸå§‹ç‰¹å¾(ACFG)æ˜ å°„åˆ°å­¦ä¹ åçš„ä»£ç é›†

> ç‰¹å¾ç¼–ç æœ‰ä¸¤ä¸ªæ˜¾è‘—çš„å¥½å¤„ã€‚é¦–å…ˆï¼Œé«˜å±‚æ¬¡ç‰¹å¾èƒ½æ›´å¥½åœ°å®¹å¿ä¸åŒæ¶æ„ä¸‹å‡½æ•°çš„å˜åŒ–ï¼Œå› ä¸ºå®ƒçš„æ¯ä¸ªç»´åº¦éƒ½æ˜¯åˆ†ç±»çš„ç›¸ä¼¼æ€§å…³ç³»ï¼Œè€Œåˆ†ç±»å¯¹äºŒå…ƒå‡½æ•°å˜åŒ–çš„æ•æ„Ÿåº¦ä½äº ACFG æœ¬èº«ã€‚

## Cross-Architecture Binary Semantics Understanding via Similar Code Comparison[^14]

tag: `2016`ï¼Œ`CCF-B`

### æ‘˜è¦

éšç€æ™ºèƒ½è®¾å¤‡ï¼ˆå¦‚æ™ºèƒ½æ‰‹æœºã€è·¯ç”±å™¨ã€æ‘„åƒå¤´ï¼‰çš„æ™®åŠï¼Œè¶Šæ¥è¶Šå¤šçš„ç¨‹åºä»ä¼ ç»Ÿçš„æ¡Œé¢å¹³å°ç§»æ¤åˆ° ARM æˆ– MIPS æ¶æ„çš„åµŒå…¥å¼ç¡¬ä»¶ä¸Šã€‚è™½ç„¶ç”±äº CPU æ¶æ„çš„ä¸åŒï¼Œç¼–è¯‘åçš„äºŒè¿›åˆ¶ä»£ç ä¹Ÿå¤§ä¸ç›¸åŒï¼Œä½†è¿™äº›ç§»æ¤ç¨‹åºå…±äº«æ¡Œé¢ç‰ˆçš„ä»£ç åº“ã€‚å› æ­¤ï¼Œåˆ©ç”¨å•†å“è®¡ç®—æœºçš„ç¨‹åºæ¥å¸®åŠ©ç†è§£è¿™äº›äº¤å‰ç¼–è¯‘çš„äºŒè¿›åˆ¶ä»£ç å¹¶æŸ¥æ‰¾å…·æœ‰ç›¸ä¼¼è¯­ä¹‰çš„å‡½æ•°æ˜¯å¯è¡Œçš„ã€‚ç„¶è€Œï¼Œç”±äºä¸åŒä½“ç³»ç»“æ„çš„æŒ‡ä»¤é›†é€šå¸¸æ˜¯ä¸å¯æ¯”çš„ï¼Œå› æ­¤å¾ˆéš¾è¿›è¡Œé™æ€çš„è·¨ä½“ç³»ç»“æ„äºŒè¿›åˆ¶ä»£ç ç›¸ä¼¼æ€§æ¯”è¾ƒã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§åŸºäºè¯­ä¹‰çš„æ–¹æ³•æ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚æˆ‘ä»¬ä»¥ç›¸åŒçš„æ–¹å¼ä»ä¸åŒå¹³å°ä¸Šçš„äºŒè¿›åˆ¶ä»£ç ä¸­**åŠ¨æ€æå–ç­¾åï¼Œç­¾åç”±æ¡ä»¶æ“ä½œè¡Œä¸ºå’Œç³»ç»Ÿè°ƒç”¨ä¿¡æ¯ç»„æˆã€‚ç„¶åæµ‹é‡ç­¾åçš„ç›¸ä¼¼æ€§**ï¼Œä»¥å¸®åŠ©è¯†åˆ«ç§»æ¤ç¨‹åºä¸­çš„å‡½æ•°ã€‚æˆ‘ä»¬åœ¨ MOCKINGBIRD ä¸­å®ç°äº†è¿™ä¸€æ–¹æ³•ï¼ŒMOCKINGBIRD æ˜¯ä¸€ç§è‡ªåŠ¨åˆ†æå·¥å…·ï¼Œç”¨äºæ¯”è¾ƒä¸åŒæ¶æ„äºŒè¿›åˆ¶æ–‡ä»¶ä¹‹é—´çš„ä»£ç ç›¸ä¼¼æ€§ã€‚MOCKINGBIRD æ”¯æŒä¸»æµæ¶æ„ï¼Œèƒ½å¤Ÿåˆ†æ Linux å¹³å°ä¸Šçš„ ELF å¯æ‰§è¡Œæ–‡ä»¶ã€‚æˆ‘ä»¬ç”¨ä¸€ç»„äº¤å‰ç¼–è¯‘ç‰ˆæœ¬çš„æµè¡Œç¨‹åºå¯¹ MOCKINGBIRD è¿›è¡Œäº†è¯„ä¼°ã€‚ç»“æœè¡¨æ˜ï¼Œæˆ‘ä»¬çš„æ–¹æ³•ä¸ä»…èƒ½æœ‰æ•ˆå¤„ç†è·¨ä½“ç³»ç»“æ„äºŒè¿›åˆ¶ä»£ç æ¯”è¾ƒè¿™ä¸€æ–°é—®é¢˜ï¼Œè€Œä¸”ç”±äºåˆ©ç”¨äº†è¯­ä¹‰ä¿¡æ¯ï¼Œè¿˜æé«˜äº†åŸºäºç›¸ä¼¼æ€§çš„å‡½æ•°è¯†åˆ«çš„å‡†ç¡®æ€§ã€‚

### å…·ä½“

ä¸»è¦æ˜¯ä¾èµ–äºæœ¬æ–‡æå–å‡ºæ¥çš„è¯­ä¹‰ç­¾åï¼Œæ¥å¯¹æ¯”äºŒè¿›åˆ¶æ–‡ä»¶é—´çš„è¯­ä¹‰;åŒæ—¶è¿˜åˆ©ç”¨äº†VEX-IRï¼Œè½¬æ¢æ±‡ç¼–æˆä¸­é—´ä»£ç ï¼Œæ›´å¥½çš„æå–è¯­ä¹‰ä¸å¯¹æ¯”

**è¯­ä¹‰ç­¾å**

ä¸»è¦ç”¨COPå–SCAçš„æ¦‚å¿µæ¥å®šä¹‰è¯­ä¹‰ç‰¹å¾ï¼ŒCOPæ˜¯æ¯”è¾ƒæŒ‡ä»¤çš„æ“ä½œæ•°å€¼å¯¹ï¼Œå®ƒåœ¨æ‰§è¡Œä¸­å¼•å…¥æ¡ä»¶æµ‹è¯•ï¼Œå¹¶å†³å®šåç»­åˆ†æ”¯æŒ‡ä»¤çš„è·³è½¬ç›®æ ‡ã€‚æ¯”å¦‚ä¸‹å›¾ä¸­IA-32çš„`cmp [ebp+arg_0], 0`ï¼Œ[ebp+arg_0], 0çš„å€¼å°±æ˜¯COPï¼Œè¿™ä¸¤ä¸ªå€¼çš„æ¯”è¾ƒç»“æœå†³å®šæ˜¯å¦è·³è½¬. **æ¯”è¾ƒæŒ‡ä»¤å¥–æ§åˆ¶ä¾èµ–å…³ç³»è½¬æ¢ä¸ºæ•°æ®ä¾èµ–å…³ç³»**ï¼Œ

![image-20230819151522607](https://raw.githubusercontent.com/Military-axe/imgtable/main/202308191554248.png)

å¯¹åº”çš„ä»£ç å¦‚ä¸‹ï¼Œå¦‚æœnum=5ï¼Œé‚£ä¹ˆæ— è®ºé‚£ä¸ªæ¶æ„çš„COPåºåˆ—éƒ½æ˜¯{(5,0),(1,0)}

![image-20230819151855312](https://raw.githubusercontent.com/Military-axe/imgtable/main/202308191554080.png)

è¯­ä¹‰ç­¾åè¿˜æœ‰SCAï¼ŒSCAæ˜¯ç”±æ‰§è¡Œä¸­è°ƒç”¨çš„ç³»ç»Ÿè°ƒç”¨åç§°å–å‚æ•°ç»„æˆï¼Œä¸‹å›¾å°±æ˜¯ä¸Šå›¾çš„ç³»ç»Ÿè°ƒç”¨

![image-20230819153037409](https://raw.githubusercontent.com/Military-axe/imgtable/main/202308191554963.png)

ç³»ç»Ÿè°ƒç”¨æœ‰ä¸€äº›æ˜¯æŒ‡é’ˆï¼Œæ‰€ä»¥éœ€è¦æå–å‡ºæŒ‡é’ˆå¯¹åº”çš„æ•°æ®ã€‚ç„¶åæ–‡ç« å°±æ˜¯æå–æŒ‡é’ˆæ•°æ®ï¼Œå‹ç¼©æ•°æ®ï¼Œè§„èŒƒæŒ‡é’ˆçš„ä¸€äº›æ“ä½œã€‚åºåˆ—æ ·å¼å¦‚ä¸‹

```tex
0x00000001    0x00000027
0x00000005    0x00000005
```

**åºåˆ—ç›¸ä¼¼æ€§æ¯”è¾ƒ**

å¯¹æ¯”åºåˆ—æœ‰å¾ˆå¤šç®—æ³•ï¼Œè¿™ç¯‡æ–‡ç« ä½¿ç”¨çš„æ˜¯æœ€é•¿å…¬å…±åºåˆ—ï¼ˆLCSï¼‰ï¼Œä½¿ç”¨jaccardæŒ‡æ•°è®¡ç®—åºåˆ—Aå’ŒBçš„ç›¸ä¼¼åº¦ã€‚\\(|A\cap B|\\)è¡¨ç¤ºä»–ä»¬çš„LCSé•¿åº¦ï¼Œ\\(|A|,|B|\\)åˆ†åˆ«è¡¨ç¤ºAå’ŒBçš„é•¿åº¦
$$
J(A,B) = \frac{|A\cap B|}{|A\cup B|}=\frac{|A\cap B|}{|A|+|B|-|A\cap B|}
$$


# å‚è€ƒ

[^1]: Jiyong Jang, David Brumley, and Shobha Venkataraman. 2011. Bitshred: feature hashing malware for scalable triage and semantic analysis. In Proceedings of the 18th ACM conference on Computer and communications security. 309â€“320. https://doi.org/10.1145/2046707.2046742
[^2]: Wesley Jin, Sagar Chaki, Cory Cohen, Arie Gurfinkel, Jeffrey Havrilla, Charles Hines, and Priya Narasimhan. 2012. Binary function clustering using semantic hashes. In 2012 11th International Conference on Machine Learning and Applications, Vol. 1. IEEE, 386â€“391. https://doi.org/10.1109/ICMLA.2012.70
[^3]: Martial Bourquin, Andy King, and Edward Robbins. 2013. Binslayer: accurate comparison of binary executables. In Proceedings of the 2nd ACM SIGPLAN Program Protection and Reverse Engineering Workshop. 1â€“10. https://doi.org/10.1145/2430553.2430557
[^4]: Silvio Cesare, Yang Xiang, and Wanlei Zhou. 2013. Control flow-based malware variant detection. IEEE Transactions on Dependable and Secure Computing 11, 4 (2013), 307â€“317. https://doi.org/10.1109/TDSC.2013.40
[^5]: Xin Hu, Kang G Shin, Sandeep Bhatkar, and Kent Griffin. 2013. {MutantX-S}: Scalable Malware Clustering Based on Static Features. In 2013 USENIX Annual Technical Conference (USENIX ATC 13). 187â€“198.[rtcl.eecs.umich.edu/papers/publications/2013/MutantX-S.pdf](https://rtcl.eecs.umich.edu/papers/publications/2013/MutantX-S.pdf)

[^6]: Lannan Luo, Jiang Ming, Dinghao Wu, Peng Liu, and Sencun Zhu. 2014. Semantics-based obfuscation-resilient binary code similarity comparison with applications to software plagiarism detection. In Proceedings of the 22nd ACM SIGSOFT International Symposium on Foundations of Software Engineering. 389â€“400. https://doi.org/10.1145/2635868.2635900
[^7]: Jannik Pewny, Felix Schuster, Lukas Bernhard, Thorsten Holz, and Christian Rossow. 2014. Leveraging semantic signatures for bug search in binary programs. In Proceedings of the 30th Annual Computer Security Applications Conference. 406â€“415. https://doi.org/10.1145/2664243.2664269
[^8]: Aylin Caliskan, Fabian Yamaguchi, Edwin Dauber, Richard Harang, Konrad Rieck, Rachel Greenstadt, and Arvind Narayanan. 2015. When coding style survives compilation: De-anonymizing programmers from executable binaries. arXiv preprint arXiv:1512.08546 (2015). https://doi.org/10.48550/arXiv.1512.08546
[^9]: Jannik Pewny, Behrad Garmany, Robert Gawlik, Christian Rossow, and Thorsten Holz. 2015. Cross-architecture bug search in binary executables. In 2015 IEEE Symposium on Security and Privacy. IEEE, 709â€“724. https://doi.org/10.1109/SP.2015.49
[^10]: Mahinthan Chandramohan, Yinxing Xue, Zhengzi Xu, Yang Liu, Chia Yuan Cho, and Hee Beng Kuan Tan. 2016. Bingo: Crossarchitecture cross-os binary search. In Proceedings of the 2016 24th ACM SIGSOFT International Symposium on Foundations of Software Engineering. 678â€“689. https://doi.org/10.1145/2950290.2950350

[^11]: Yaniv David, Nimrod Partush, and Eran Yahav. 2016. Statistical similarity of binaries. Acm Sigplan Notices 51, 6 (2016), 266â€“280. https://doi.org/10.1145/2908080.2908126
[^12]: Sebastian Eschweiler, Khaled Yakdan, and Elmar Gerhards-Padilla. 2016. discovRE: Efficient Cross-Architecture Identification of Bugs in Binary Code.. In NDSS, Vol. 52. 58â€“79. https://doi.org/10.14722/ndss.2016.23185
[^13]: Qian Feng, Rundong Zhou, Chengcheng Xu, Yao Cheng, Brian Testa, and Heng Yin. 2016. Scalable Graph-based Bug Search for Firmware Images. In Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security (CCS '16). Association for Computing Machinery, New York, NY, USA, 480â€“491. https://doi.org/10.1145/2976749.2978370
[^14]: Yikun Hu, Yuanyuan Zhang, Juanru Li, and Dawu Gu. 2016. Crossarchitecture binary semantics understanding via similar code comparison. In 2016 IEEE 23rd International Conference on Software Analysis, Evolution, and Reengineering (SANER), Vol. 1. IEEE, 57â€“67. https://doi.org/10.1109/SANER.2016.50
[^15]: Tim Blazytko, Moritz Contag, Cornelius Aschermann, and Thorsten Holz. 2017. Syntia: Synthesizing the semantics of obfuscated code. In 26th USENIX Security Symposium (USENIX Security 17). 643â€“659.[sec17-blazytko.pdf (usenix.org)](https://www.usenix.org/system/files/conference/usenixsecurity17/sec17-blazytko.pdf)

[^16]: Yaniv David, Nimrod Partush, and Eran Yahav. 2017. Similarity of binaries through re-optimization. In Proceedings of the 38th ACM SIGPLAN Conference on Programming Language Design and Implementation. 7994. https://doi.org/10.1145/3062341.3062387

[^17]: Qian Feng, Minghua Wang, Mu Zhang, Rundong Zhou, Andrew Henderson, and Heng Yin. 2017. Extracting conditional formulas for cross-platform bug search. In Proceedings of the 2017 ACM on Asia Conference on Computer and Communications Security. 346â€“359. https://doi.org/10.1145/3052973.3052995

[^18]: Yikun Hu, Yuanyuan Zhang, Juanru Li, and Dawu Gu. 2017. Binary code clone detection across architectures and compiling configurations. In 2017 IEEE/ACM 25th International Conference on Program Comprehension (ICPC). IEEE, 88â€“98. https://doi.org/10.1109/ICPC.2017.22

[^19]: He Huang, Amr M Youssef, and Mourad Debbabi. 2017. Binsequence: Fast, accurate and scalable binary code reuse detection. In Proceedings of the 2017 ACM on Asia Conference on Computer and Communications Security. 155â€“166. https://doi.org/10.1145/3052973.3052974

[^20]: Jiang Ming, Dongpeng Xu, Yufei Jiang, and Dinghao Wu. 2017. {BinSim}: Trace-based Semantic Binary Diffing via System Call Sliced Segment Equivalence Checking. In 26th USENIX Security Symposium (USENIX Security 17). 253â€“270.[sec17-ming.pdf (usenix.org)](https://www.usenix.org/system/files/conference/usenixsecurity17/sec17-ming.pdf)

[^21]: Shuai Wang and Dinghao Wu. 2017. In-memory fuzzing for binary code similarity analysis. In 2017 32nd IEEE/ACM International Conference on Automated Software Engineering (ASE). IEEE, 319â€“330. https://doi.org/10.1109/ASE.2017.8115645

[^22]: Dongpeng Xu, Jiang Ming, and Dinghao Wu. 2017. Cryptographic function detection in obfuscated binaries via bit-precise symbolic loop mapping. In 2017 IEEE Symposium on Security and Privacy (SP). IEEE, 921â€“937. https://doi.org/10.1109/SP.2017.56

[^23]: Xiaojun Xu, Chang Liu, Qian Feng, Heng Yin, Le Song, and Dawn Song. 2017. Neural network-based graph embedding for cross-platform binary code similarity detection. In Proceedings of the 2017 ACM SIGSAC Conference on Computer and Communications Security. 363376. https://doi.org/10.1145/3133956.3134018

[^24]: Zhengzi Xu, Bihuan Chen, Mahinthan Chandramohan, Yang Liu, and Fu Song. 2017. Spain: security patch analysis for binaries towards understanding the pain and pills. In 2017 IEEE/ACM 39th International Conference on Software Engineering (ICSE). IEEE, 462â€“472. https://doi.org/10.1109/ICSE.2017.49

[^25]: Saed Alrabaee, Paria Shirani, Lingyu Wang, and Mourad Debbabi. 2018. Fossil: a resilient and efficient system for identifying foss functions in malware binaries. ACM Transactions on Privacy and Security (TOPS) 21, 2 (2018), 1â€“34. https://doi.org/10.1145/3175492

[^26]: Yaniv David, Nimrod Partush, and Eran Yahav. 2018. Firmup: Precise static detection of common vulnerabilities in firmware. ACM SIGPLAN Notices 53, 2 (2018), 392â€“404. https://doi.org/10.1145/3173162.3177157

[^27]: Jian Gao, Xin Yang, Ying Fu, Yu Jiang, and Jiaguang Sun. 2018. VulSeeker: A semantic learning based vulnerability seeker for crossplatform binary. In 2018 33rd IEEE/ACM International Conference on Automated Software Engineering (ASE). IEEE, 896â€“899. https://doi.org/10.1145/3238147.3240480

[^28]: Yikun Hu, Yuanyuan Zhang, Juanru Li, Hui Wang, Bodong Li, and Dawu Gu. 2018. Binmatch: A semantics-based hybrid approach on binary code clone analysis. In 2018 IEEE International Conference on Software Maintenance and Evolution (ICSME). IEEE, 104â€“114. https://doi.org/10.1109/ICSME.2018.00019

[^29]: Bingchang Liu, Wei Huo, Chao Zhang, Wenchao Li, Feng Li, Aihua Piao, and Wei Zou. 2018. ğ›¼diff: cross-version binary code similarity detection with dnn. In Proceedings of the 33rd ACM/IEEE International Conference on Automated Software Engineering. 667â€“678. https://doi.org/10.1145/3238147.3238199

[^30]: Yinxing Xue, Zhengzi Xu, Mahinthan Chandramohan, and Yang Liu. 2018. Accurate and scalable cross-architecture cross-os binary code search with emulation. IEEE Transactions on Software Engineering 45, 11 (2018), 1125â€“1149. https://doi.org/10.1109/TSE.2018.2827379

[^31]: Steven HH Ding, Benjamin CM Fung, and Philippe Charland. 2019. Asm2vec: Boosting static representation robustness for binary clone search against code obfuscation and compiler optimization. In 2019 IEEE Symposium on Security and Privacy (SP). IEEE, 472â€“489. https://doi.org/10.1109/SP.2019.00003

[^32]: Fei Zuo, Xiaopeng Li, Patrick Young, Lannan Luo, Qiang Zeng, and Zhexin Zhang. 2019. Neural Machine Translation Inspired Binary Code Similarity Comparison beyond Function Pairs. In NDSS. The Internet Society. https://doi.org/10.14722/ndss.2019.23492

[^33]: Yue Duan, Xuezixiang Li, Jinghan Wang, and Heng Yin. 2020. Deepbindiff: Learning program-wide code representations for binary diffing. In Network and Distributed System Security Symposium. https: //doi.org/10.14722/ndss.2020.24311

[^34]: Yifei Xu, Zhengzi Xu, Bihuan Chen, Fu Song, Yang Liu, and Ting Liu. 2020. Patch based vulnerability matching for binary programs. In Proceedings of the 29th ACM SIGSOFT International Symposium on Software Testing and Analysis. 376â€“387. https://doi.org/10.1145/3395363.3397361

[^35]: Lei Zhao, Yuncong Zhu, Jiang Ming, Yichen Zhang, Haotian Zhang, and Heng Yin. 2020. Patchscope: Memory object centric patch diffing. In Proceedings of the 2020 ACM SIGSAC Conference on Computer and Communications Security. 149â€“165. https://doi.org/10.1145/3372297.3423342

[^36]: Irfan Ul Haq and Juan Caballero. 2021. A survey of binary code similarity. ACM Computing Surveys (CSUR) 54, 3 (2021), 1â€“38. https://doi.org/10.1145/3446371

[^37]: Xian Zhan, Lingling Fan, Sen Chen, Feng Wu, Tianming Liu, Xiapu Luo, and Yang Liu. 2021. Atvhunter: Reliable version detection of third-party libraries for vulnerability identification in android applications. In 2021 IEEE/ACM 43rd International Conference on Software Engineering (ICSE). IEEE, 1695â€“1707. https://doi.org/10.1109/ICSE43902.2021.00150

[^38]: Huaijin Wang, Pingchuan Ma, Yuanyuan Yuan, Zhibo Liu, Shuai Wang, Qiyi Tang, Sen Nie, and Shi Wu. 2022. Enhancing DNN-Based Binary Code Function Search With Low-Cost Equivalence Checking. IEEE Transactions on Software Engineering (2022). https://doi.org/10.1109/TSE.2022.3149240
[^39]: Hao Wang, Wenjie Qu, Gilad Katz, Wenyu Zhu, Zeyu Gao, Han Qiu, Jianwei Zhuge, and Chao Zhang. 2022. jTrans: Jump-Aware Transformer for Binary Code Similarity. arXiv preprint arXiv:2205.12713 (2022). https://doi.org/10.48550/arXiv.2205.12713
[^40]: zynamics GmbH and Google LLC. 2022. BinDiff Manual. http://www.zynamics.com/bindiff/manual/index.html.

[^41]: [éšæœºæ£®æ—è¯¦è§£ï¼ˆä»å†³ç­–æ ‘ç†è§£éšæœºæ£®æ—ï¼‰ - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/471494060)
[^42]: [è‡ªç„¶è¯­è¨€å¤„ç†ä¸­N-Gramæ¨¡å‹ä»‹ç» - çŸ¥ä¹ (zhihu.com)](https://zhuanlan.zhihu.com/p/32829048)